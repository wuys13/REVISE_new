simulation
         spot_name     cell_id true_cell_type             x             y
0         SPOT_0_0  iamobelc-1          Tumor  42093.212592   8087.496557
1         SPOT_0_1  ialoniok-1          Tumor  42076.900367   8175.764542
2         SPOT_0_1  iamoafno-1          Tumor  42062.405471   8095.644405
3         SPOT_0_1  iamoncjo-1          Tumor  42039.033615   8161.575722
4         SPOT_0_1  ianagaje-1          Tumor  42052.560519   8125.708684
...            ...         ...            ...           ...           ...
14055   SPOT_99_49  ilpeknpj-1     Fibroblast  51916.678682  12910.613080
14056   SPOT_100_0  nmgfhaff-1          Tumor  51996.287148   8016.631452
14057  SPOT_100_28  nomkdflc-1     Fibroblast  51999.269566  10800.853998
14058  SPOT_100_33  ilgbgpdg-1     Fibroblast  51999.729636  11320.958332
14059  SPOT_100_48  imapnibk-1     Fibroblast  51998.910169  12810.612761

[14060 rows x 5 columns]
There are 5 cell types: ['Fibroblast', 'Mono/Macro', 'T', 'Tumor', 'Vascular EC']
label
Fibroblast     50
Mono/Macro     50
T              50
Tumor          50
Vascular EC    50
Name: count, dtype: int64
0it [00:00, ?it/s]5it [00:00, 663.66it/s]
0it [00:00, ?it/s]5it [00:00, 451.88it/s]
(5, 250) (5, 500)
Calculating cell contributions and PM_on_cell...
[0.97077084 0.97327524 0.9712896  ... 0.96367645 0.9622986  0.9651632 ]
Assigning cell types:   0%|          | 0/3989 [00:00<?, ?it/s]Assigning cell types:   9%|▊         | 341/3989 [00:00<00:01, 3403.06it/s]Assigning cell types:  18%|█▊        | 716/3989 [00:00<00:00, 3605.35it/s]Assigning cell types:  27%|██▋       | 1093/3989 [00:00<00:00, 3679.59it/s]Assigning cell types:  37%|███▋      | 1461/3989 [00:00<00:00, 3608.15it/s]Assigning cell types:  46%|████▌     | 1842/3989 [00:00<00:00, 3677.42it/s]Assigning cell types:  56%|█████▌    | 2224/3989 [00:00<00:00, 3723.15it/s]Assigning cell types:  65%|██████▌   | 2600/3989 [00:00<00:00, 3733.54it/s]Assigning cell types:  75%|███████▍  | 2978/3989 [00:00<00:00, 3747.55it/s]Assigning cell types:  84%|████████▍ | 3358/3989 [00:00<00:00, 3762.23it/s]Assigning cell types:  94%|█████████▎| 3738/3989 [00:01<00:00, 3772.52it/s]Assigning cell types: 100%|██████████| 3989/3989 [00:01<00:00, 3720.07it/s]
match
True     13562
False      498
Name: count, dtype: int64 0.9645803698435277
SPOT_98_0 -1.0 7 8.0 [1. 0. 2. 5. 0.]
SPOT_98_0 0.0 7 8.0 [0. 0. 2. 5. 0.]
Assigning cell types...
Assigning cell types:   0%|          | 0/3989 [00:00<?, ?it/s]Assigning cell types:   2%|▏         | 62/3989 [00:00<00:06, 617.64it/s]Assigning cell types:   3%|▎         | 130/3989 [00:00<00:05, 652.33it/s]Assigning cell types:   5%|▌         | 200/3989 [00:00<00:05, 670.98it/s]Assigning cell types:   7%|▋         | 270/3989 [00:00<00:05, 679.11it/s]Assigning cell types:   9%|▊         | 340/3989 [00:00<00:05, 685.10it/s]Assigning cell types:  10%|█         | 410/3989 [00:00<00:05, 687.71it/s]Assigning cell types:  12%|█▏        | 479/3989 [00:00<00:05, 687.25it/s]Assigning cell types:  14%|█▍        | 549/3989 [00:00<00:04, 689.90it/s]Assigning cell types:  15%|█▌        | 618/3989 [00:00<00:04, 685.24it/s]Assigning cell types:  17%|█▋        | 688/3989 [00:01<00:04, 688.05it/s]Assigning cell types:  19%|█▉        | 758/3989 [00:01<00:04, 689.12it/s]Assigning cell types:  21%|██        | 828/3989 [00:01<00:04, 690.72it/s]Assigning cell types:  23%|██▎       | 898/3989 [00:01<00:04, 691.63it/s]Assigning cell types:  24%|██▍       | 968/3989 [00:01<00:04, 691.78it/s]Assigning cell types:  26%|██▌       | 1038/3989 [00:01<00:04, 692.28it/s]Assigning cell types:  28%|██▊       | 1108/3989 [00:01<00:04, 694.52it/s]Assigning cell types:  30%|██▉       | 1178/3989 [00:01<00:04, 694.41it/s]Assigning cell types:  31%|███▏      | 1249/3989 [00:01<00:03, 696.42it/s]Assigning cell types:  33%|███▎      | 1319/3989 [00:01<00:03, 696.80it/s]Assigning cell types:  35%|███▍      | 1390/3989 [00:02<00:03, 698.11it/s]Assigning cell types:  37%|███▋      | 1460/3989 [00:02<00:03, 696.99it/s]Assigning cell types:  38%|███▊      | 1530/3989 [00:02<00:03, 694.47it/s]Assigning cell types:  40%|████      | 1600/3989 [00:02<00:03, 694.27it/s]Assigning cell types:  42%|████▏     | 1670/3989 [00:02<00:03, 685.63it/s]Assigning cell types:  44%|████▎     | 1739/3989 [00:02<00:03, 684.02it/s]Assigning cell types:  45%|████▌     | 1808/3989 [00:02<00:03, 683.40it/s]Assigning cell types:  47%|████▋     | 1878/3989 [00:02<00:03, 686.15it/s]Assigning cell types:  49%|████▉     | 1948/3989 [00:02<00:02, 688.89it/s]Assigning cell types:  51%|█████     | 2018/3989 [00:02<00:02, 689.64it/s]Assigning cell types:  52%|█████▏    | 2088/3989 [00:03<00:02, 690.61it/s]Assigning cell types:  54%|█████▍    | 2158/3989 [00:03<00:02, 690.90it/s]Assigning cell types:  56%|█████▌    | 2228/3989 [00:03<00:02, 692.07it/s]Assigning cell types:  58%|█████▊    | 2298/3989 [00:03<00:02, 691.44it/s]Assigning cell types:  59%|█████▉    | 2368/3989 [00:03<00:02, 687.61it/s]Assigning cell types:  61%|██████    | 2437/3989 [00:03<00:02, 687.94it/s]Assigning cell types:  63%|██████▎   | 2506/3989 [00:03<00:02, 684.75it/s]Assigning cell types:  65%|██████▍   | 2575/3989 [00:03<00:02, 683.09it/s]Assigning cell types:  66%|██████▋   | 2644/3989 [00:03<00:01, 683.71it/s]Assigning cell types:  68%|██████▊   | 2713/3989 [00:03<00:01, 683.62it/s]Assigning cell types:  70%|██████▉   | 2782/3989 [00:04<00:01, 685.15it/s]Assigning cell types:  71%|███████▏  | 2851/3989 [00:04<00:01, 684.19it/s]Assigning cell types:  73%|███████▎  | 2920/3989 [00:04<00:01, 683.64it/s]Assigning cell types:  75%|███████▍  | 2989/3989 [00:04<00:01, 685.46it/s]Assigning cell types:  77%|███████▋  | 3058/3989 [00:04<00:01, 677.31it/s]Assigning cell types:  78%|███████▊  | 3127/3989 [00:04<00:01, 679.03it/s]Assigning cell types:  80%|████████  | 3197/3989 [00:04<00:01, 682.53it/s]Assigning cell types:  82%|████████▏ | 3267/3989 [00:04<00:01, 685.87it/s]Assigning cell types:  84%|████████▎ | 3337/3989 [00:04<00:00, 688.40it/s]Assigning cell types:  85%|████████▌ | 3407/3989 [00:04<00:00, 690.17it/s]Assigning cell types:  87%|████████▋ | 3477/3989 [00:05<00:00, 689.92it/s]Assigning cell types:  89%|████████▉ | 3546/3989 [00:05<00:00, 689.76it/s]Assigning cell types:  91%|█████████ | 3615/3989 [00:05<00:00, 689.26it/s]Assigning cell types:  92%|█████████▏| 3685/3989 [00:05<00:00, 689.71it/s]Assigning cell types:  94%|█████████▍| 3754/3989 [00:05<00:00, 689.50it/s]Assigning cell types:  96%|█████████▌| 3823/3989 [00:05<00:00, 687.88it/s]Assigning cell types:  98%|█████████▊| 3892/3989 [00:05<00:00, 684.84it/s]Assigning cell types:  99%|█████████▉| 3961/3989 [00:05<00:00, 685.15it/s]Assigning cell types: 100%|██████████| 3989/3989 [00:05<00:00, 687.27it/s]
         spot_name     cell_id true_cell_type  ...             y   cell_type match
0         SPOT_0_0  iamobelc-1          Tumor  ...   8087.496557       Tumor  True
1         SPOT_0_1  ialoniok-1          Tumor  ...   8175.764542       Tumor  True
2         SPOT_0_1  iamoafno-1          Tumor  ...   8095.644405       Tumor  True
3         SPOT_0_1  iamoncjo-1          Tumor  ...   8161.575722       Tumor  True
4         SPOT_0_1  ianagaje-1          Tumor  ...   8125.708684       Tumor  True
...            ...         ...            ...  ...           ...         ...   ...
14055   SPOT_99_49  ilpeknpj-1     Fibroblast  ...  12910.613080  Fibroblast  True
14056   SPOT_100_0  nmgfhaff-1          Tumor  ...   8016.631452       Tumor  True
14057  SPOT_100_28  nomkdflc-1     Fibroblast  ...  10800.853998  Fibroblast  True
14058  SPOT_100_33  ilgbgpdg-1     Fibroblast  ...  11320.958332  Fibroblast  True
14059  SPOT_100_48  imapnibk-1     Fibroblast  ...  12810.612761  Fibroblast  True

[14060 rows x 7 columns]
match
True     14037
False       23
Name: count, dtype: int64 0.9983641536273116
Constructing SVC adata...
Number of cells processed: 14060
Number of unique spots: 3989
Shape of SVC_X: (14060, 500)
AnnData object with n_obs × n_vars = 14060 × 500
    obs: 'spot_name', 'cell_id', 'true_cell_type', 'x', 'y', 'cell_type', 'match'
500 500 500
Normalizing and log-transforming data.
PCC: 0.9357, 0.9987, 0.7945
SSIM: 0.5891, 0.9847, 0.3605
MSE: 0.0841, 0.1739, 0.0093
NRMSE: 0.2297, 0.9271, 0.0377
Normalizing and log-transforming data.
PCC: 0.9357, 0.9987, 0.7945
SSIM: 0.5893, 0.9849, 0.3601
MSE: 0.0039, 0.0106, 0.0004
NRMSE: 0.2311, 0.9271, 0.0462


PCC: 0.9864, 0.9963, 0.9562
SSIM: 0.8315, 0.9951, 0.5768
MSE: 13.8367, 46.0206, 1.6739
NRMSE: 0.3873, 1.4664, 0.0913
PCC: 0.9864, 0.9963, 0.9562
SSIM: 0.8325, 0.9952, 0.5759
MSE: 0.0016, 0.0130, 0.0002
NRMSE: 0.4056, 1.4665, 0.0890
Finish
