simulation
        spot_name     cell_id true_cell_type             x             y
0        SPOT_0_0  kdnfclga-1          Tumor  60127.455944  10134.285218
1        SPOT_0_0  kdnfddfd-1          Tumor  60107.220221  10121.761419
2        SPOT_0_0  kdnfimna-1          Tumor  60053.320160  10165.841206
3        SPOT_0_0  kdnfmcil-1          Tumor  60058.297940  10194.604531
4        SPOT_0_0  kdnfocni-1          Tumor  60114.092273  10184.750938
...           ...         ...            ...           ...           ...
27061  SPOT_25_10  abdaebgm-1          Tumor  64998.906417  12021.306081
27062  SPOT_25_14  abgpglel-1          Tumor  64999.350144  12816.212020
27063  SPOT_25_19  gcacponh-1          Tumor  64999.642882  13905.364321
27064  SPOT_25_24  gfobhfgf-1          Tumor  64999.818122  14812.878338
27065  SPOT_25_29  bgmpchhj-1          Tumor  64999.282916  15886.603271

[27066 rows x 5 columns]
There are 5 cell types: ['Mono/Macro', 'Plasma', 'T', 'Tumor', 'Vascular EC']
label
Mono/Macro     50
Plasma         50
T              50
Tumor          50
Vascular EC    50
Name: count, dtype: int64
0it [00:00, ?it/s]5it [00:00, 405.98it/s]
0it [00:00, ?it/s]5it [00:00, 343.68it/s]
(5, 250) (5, 500)
Calculating cell contributions and PM_on_cell...
Training:   0%|          | 0/4000 [00:00<?, ?it/s]Training:   0%|          | 1/4000 [00:00<41:18,  1.61it/s]Training:   0%|          | 8/4000 [00:00<04:43, 14.09it/s]Training:   0%|          | 15/4000 [00:00<02:36, 25.48it/s]Training:   1%|          | 22/4000 [00:00<01:52, 35.38it/s]Training:   1%|          | 29/4000 [00:01<01:31, 43.40it/s]Training:   1%|          | 36/4000 [00:01<01:20, 49.28it/s]Training:   1%|          | 43/4000 [00:01<01:13, 54.17it/s]Training:   1%|▏         | 50/4000 [00:01<01:08, 57.91it/s]Training:   1%|▏         | 57/4000 [00:01<01:05, 60.38it/s]Training:   2%|▏         | 64/4000 [00:01<01:03, 62.30it/s]Training:   2%|▏         | 71/4000 [00:01<01:01, 63.72it/s]Training:   2%|▏         | 78/4000 [00:01<01:00, 64.73it/s]Training:   2%|▏         | 85/4000 [00:01<00:59, 65.59it/s]Training:   2%|▏         | 92/4000 [00:01<00:59, 65.98it/s]Training:   2%|▏         | 99/4000 [00:02<00:58, 66.30it/s]Training:   3%|▎         | 106/4000 [00:02<00:58, 66.65it/s]Training:   3%|▎         | 113/4000 [00:02<00:58, 66.59it/s]Training:   3%|▎         | 120/4000 [00:02<00:58, 66.88it/s]Training:   3%|▎         | 127/4000 [00:02<00:57, 66.85it/s]Training:   3%|▎         | 134/4000 [00:02<00:57, 67.01it/s]Training:   4%|▎         | 141/4000 [00:02<00:57, 67.05it/s]Training:   4%|▎         | 148/4000 [00:02<00:57, 67.04it/s]Training:   4%|▍         | 155/4000 [00:02<00:57, 67.14it/s]Training:   4%|▍         | 162/4000 [00:03<00:57, 66.75it/s]Training:   4%|▍         | 169/4000 [00:03<00:57, 67.17it/s]Training:   4%|▍         | 176/4000 [00:03<00:57, 67.08it/s]Training:   5%|▍         | 183/4000 [00:03<00:57, 66.86it/s]Training:   5%|▍         | 190/4000 [00:03<00:56, 66.94it/s]Training:   5%|▍         | 197/4000 [00:03<00:56, 67.17it/s]Training:   5%|▌         | 204/4000 [00:03<00:56, 67.05it/s]Training:   5%|▌         | 211/4000 [00:03<00:56, 67.11it/s]Training:   5%|▌         | 218/4000 [00:03<00:56, 67.38it/s]Training:   6%|▌         | 225/4000 [00:03<00:56, 67.16it/s]Training:   6%|▌         | 232/4000 [00:04<00:56, 66.96it/s]Training:   6%|▌         | 239/4000 [00:04<00:56, 66.95it/s]Training:   6%|▌         | 246/4000 [00:04<00:55, 67.28it/s]Training:   6%|▋         | 253/4000 [00:04<00:55, 66.98it/s]Training:   6%|▋         | 260/4000 [00:04<00:55, 66.90it/s]Training:   7%|▋         | 267/4000 [00:04<00:55, 66.86it/s]Training:   7%|▋         | 274/4000 [00:04<00:55, 66.94it/s]Training:   7%|▋         | 281/4000 [00:04<00:55, 66.43it/s]Training:   7%|▋         | 288/4000 [00:04<00:55, 66.58it/s]Training:   7%|▋         | 295/4000 [00:05<00:55, 66.59it/s]Training:   8%|▊         | 302/4000 [00:05<00:55, 66.92it/s]Training:   8%|▊         | 309/4000 [00:05<00:55, 66.81it/s]Training:   8%|▊         | 316/4000 [00:05<00:55, 66.64it/s]Training:   8%|▊         | 323/4000 [00:05<00:55, 66.51it/s]Training:   8%|▊         | 330/4000 [00:05<00:55, 66.52it/s]Training:   8%|▊         | 337/4000 [00:05<00:54, 66.70it/s]Training:   9%|▊         | 344/4000 [00:05<00:54, 66.61it/s]Training:   9%|▉         | 351/4000 [00:05<00:54, 66.61it/s]Training:   9%|▉         | 358/4000 [00:05<00:54, 66.97it/s]Training:   9%|▉         | 365/4000 [00:06<00:54, 66.91it/s]Training:   9%|▉         | 372/4000 [00:06<00:54, 66.91it/s]Training:   9%|▉         | 379/4000 [00:06<00:54, 66.95it/s]Training:  10%|▉         | 386/4000 [00:06<00:54, 66.78it/s]Training:  10%|▉         | 393/4000 [00:06<00:54, 66.68it/s]Training:  10%|█         | 400/4000 [00:06<00:53, 66.68it/s]Training:  10%|█         | 407/4000 [00:06<00:54, 66.51it/s]Training:  10%|█         | 414/4000 [00:06<00:53, 66.55it/s]Training:  11%|█         | 421/4000 [00:06<00:53, 66.60it/s]Training:  11%|█         | 428/4000 [00:07<00:53, 66.64it/s]Training:  11%|█         | 435/4000 [00:07<00:53, 66.96it/s]Training:  11%|█         | 442/4000 [00:07<00:53, 67.12it/s]Training:  11%|█         | 449/4000 [00:07<00:52, 67.09it/s]Training:  11%|█▏        | 456/4000 [00:07<00:52, 67.03it/s]Training:  12%|█▏        | 463/4000 [00:07<00:52, 66.93it/s]Training:  12%|█▏        | 470/4000 [00:07<00:52, 66.87it/s]Training:  12%|█▏        | 477/4000 [00:07<00:52, 66.91it/s]Training:  12%|█▏        | 484/4000 [00:07<00:52, 67.14it/s]Training:  12%|█▏        | 491/4000 [00:07<00:52, 67.02it/s]Training:  12%|█▏        | 498/4000 [00:08<00:52, 67.22it/s]Training:  13%|█▎        | 505/4000 [00:08<00:52, 67.03it/s]Training:  13%|█▎        | 512/4000 [00:08<00:52, 66.93it/s]Training:  13%|█▎        | 519/4000 [00:08<00:52, 66.92it/s]Training:  13%|█▎        | 526/4000 [00:08<00:52, 66.39it/s]Training:  13%|█▎        | 533/4000 [00:08<00:52, 66.64it/s]Training:  14%|█▎        | 540/4000 [00:08<00:51, 66.65it/s]Training:  14%|█▎        | 547/4000 [00:08<00:51, 66.86it/s]Training:  14%|█▍        | 554/4000 [00:08<00:51, 66.99it/s]Training:  14%|█▍        | 561/4000 [00:08<00:51, 67.17it/s]Training:  14%|█▍        | 568/4000 [00:09<00:50, 67.44it/s]Training:  14%|█▍        | 575/4000 [00:09<00:50, 67.27it/s]Training:  15%|█▍        | 582/4000 [00:09<00:50, 67.29it/s]Training:  15%|█▍        | 589/4000 [00:09<00:50, 67.24it/s]Training:  15%|█▍        | 596/4000 [00:09<00:50, 67.13it/s]Training:  15%|█▌        | 603/4000 [00:09<00:50, 66.97it/s]Training:  15%|█▌        | 610/4000 [00:09<00:50, 67.04it/s]Training:  15%|█▌        | 617/4000 [00:09<00:50, 67.03it/s]Training:  16%|█▌        | 624/4000 [00:09<00:50, 67.15it/s]Training:  16%|█▌        | 631/4000 [00:10<00:50, 67.38it/s]Training:  16%|█▌        | 638/4000 [00:10<00:50, 67.12it/s]Training:  16%|█▌        | 645/4000 [00:10<00:49, 67.22it/s]Training:  16%|█▋        | 652/4000 [00:10<00:49, 67.15it/s]Training:  16%|█▋        | 659/4000 [00:10<00:49, 67.02it/s]Training:  17%|█▋        | 666/4000 [00:10<00:49, 67.12it/s]Training:  17%|█▋        | 673/4000 [00:10<00:49, 67.03it/s]Training:  17%|█▋        | 680/4000 [00:10<00:49, 67.18it/s]Training:  17%|█▋        | 687/4000 [00:10<00:49, 67.10it/s]Training:  17%|█▋        | 694/4000 [00:10<00:49, 66.99it/s]Training:  18%|█▊        | 701/4000 [00:11<00:49, 66.89it/s]Training:  18%|█▊        | 708/4000 [00:11<00:49, 66.84it/s]Training:  18%|█▊        | 715/4000 [00:11<00:49, 66.66it/s]Training:  18%|█▊        | 722/4000 [00:11<00:49, 66.76it/s]Training:  18%|█▊        | 729/4000 [00:11<00:48, 66.76it/s]Training:  18%|█▊        | 736/4000 [00:11<00:48, 66.84it/s]Training:  19%|█▊        | 743/4000 [00:11<00:48, 66.63it/s]Training:  19%|█▉        | 750/4000 [00:11<00:48, 66.46it/s]Training:  19%|█▉        | 757/4000 [00:11<00:48, 66.38it/s]Training:  19%|█▉        | 764/4000 [00:12<00:49, 65.67it/s]Training:  19%|█▉        | 771/4000 [00:12<00:49, 65.74it/s]Training:  19%|█▉        | 778/4000 [00:12<00:48, 65.89it/s]Training:  20%|█▉        | 785/4000 [00:12<00:48, 65.85it/s]Training:  20%|█▉        | 792/4000 [00:12<00:48, 65.99it/s]Training:  20%|█▉        | 799/4000 [00:12<00:48, 66.10it/s]Training:  20%|██        | 806/4000 [00:12<00:48, 65.95it/s]Training:  20%|██        | 813/4000 [00:12<00:48, 66.02it/s]Training:  20%|██        | 820/4000 [00:12<00:48, 66.03it/s]Training:  21%|██        | 827/4000 [00:12<00:48, 65.97it/s]Training:  21%|██        | 834/4000 [00:13<00:48, 65.86it/s]Training:  21%|██        | 841/4000 [00:13<00:47, 66.14it/s]Training:  21%|██        | 848/4000 [00:13<00:47, 65.99it/s]Training:  21%|██▏       | 855/4000 [00:13<00:47, 66.05it/s]Training:  22%|██▏       | 862/4000 [00:13<00:47, 66.04it/s]Training:  22%|██▏       | 869/4000 [00:13<00:47, 66.00it/s]Training:  22%|██▏       | 876/4000 [00:13<00:47, 66.14it/s]Training:  22%|██▏       | 883/4000 [00:13<00:47, 66.04it/s]Training:  22%|██▏       | 890/4000 [00:13<00:47, 65.82it/s]Training:  22%|██▏       | 897/4000 [00:14<00:47, 65.94it/s]Training:  23%|██▎       | 904/4000 [00:14<00:46, 65.93it/s]Training:  23%|██▎       | 911/4000 [00:14<00:46, 65.94it/s]Training:  23%|██▎       | 918/4000 [00:14<00:46, 65.85it/s]Training:  23%|██▎       | 925/4000 [00:14<00:46, 65.97it/s]Training:  23%|██▎       | 932/4000 [00:14<00:46, 66.06it/s]Training:  23%|██▎       | 939/4000 [00:14<00:46, 66.24it/s]Training:  24%|██▎       | 946/4000 [00:14<00:46, 66.38it/s]Training:  24%|██▍       | 953/4000 [00:14<00:45, 66.24it/s]Training:  24%|██▍       | 960/4000 [00:14<00:45, 66.37it/s]Training:  24%|██▍       | 967/4000 [00:15<00:45, 66.55it/s]Training:  24%|██▍       | 974/4000 [00:15<00:45, 66.42it/s]Training:  25%|██▍       | 981/4000 [00:15<00:45, 66.33it/s]Training:  25%|██▍       | 988/4000 [00:15<00:45, 66.32it/s]Training:  25%|██▍       | 995/4000 [00:15<00:45, 66.35it/s]Training:  25%|██▌       | 1002/4000 [00:15<00:45, 66.24it/s]Training:  25%|██▌       | 1009/4000 [00:15<00:45, 65.69it/s]Training:  25%|██▌       | 1016/4000 [00:15<00:45, 65.79it/s]Training:  26%|██▌       | 1023/4000 [00:15<00:45, 65.78it/s]Training:  26%|██▌       | 1030/4000 [00:16<00:45, 65.98it/s]Training:  26%|██▌       | 1037/4000 [00:16<00:44, 66.00it/s]Training:  26%|██▌       | 1044/4000 [00:16<00:44, 66.02it/s]Training:  26%|██▋       | 1051/4000 [00:16<00:44, 66.21it/s]Training:  26%|██▋       | 1058/4000 [00:16<00:44, 66.33it/s]Training:  27%|██▋       | 1065/4000 [00:16<00:44, 66.56it/s]Training:  27%|██▋       | 1072/4000 [00:16<00:43, 66.61it/s]Training:  27%|██▋       | 1079/4000 [00:16<00:43, 66.50it/s]Training:  27%|██▋       | 1086/4000 [00:16<00:43, 66.49it/s]Training:  27%|██▋       | 1093/4000 [00:17<00:43, 66.68it/s]Training:  28%|██▊       | 1100/4000 [00:17<00:43, 66.83it/s]Training:  28%|██▊       | 1107/4000 [00:17<00:43, 66.96it/s]Training:  28%|██▊       | 1114/4000 [00:17<00:43, 66.88it/s]Training:  28%|██▊       | 1121/4000 [00:17<00:42, 67.10it/s]Training:  28%|██▊       | 1128/4000 [00:17<00:42, 66.84it/s]Training:  28%|██▊       | 1135/4000 [00:17<00:42, 66.65it/s]Training:  29%|██▊       | 1142/4000 [00:17<00:42, 66.64it/s]Training:  29%|██▊       | 1149/4000 [00:17<00:42, 66.62it/s]Training:  29%|██▉       | 1156/4000 [00:17<00:42, 66.69it/s]Training:  29%|██▉       | 1163/4000 [00:18<00:42, 66.51it/s]Training:  29%|██▉       | 1170/4000 [00:18<00:42, 66.49it/s]Training:  29%|██▉       | 1177/4000 [00:18<00:42, 66.53it/s]Training:  30%|██▉       | 1184/4000 [00:18<00:42, 66.79it/s]Training:  30%|██▉       | 1191/4000 [00:18<00:41, 66.91it/s]Training:  30%|██▉       | 1198/4000 [00:18<00:41, 66.95it/s]Training:  30%|███       | 1205/4000 [00:18<00:41, 67.03it/s]Training:  30%|███       | 1212/4000 [00:18<00:41, 66.59it/s]Training:  30%|███       | 1219/4000 [00:18<00:41, 66.65it/s]Training:  31%|███       | 1226/4000 [00:18<00:41, 66.61it/s]Training:  31%|███       | 1233/4000 [00:19<00:41, 66.71it/s]Training:  31%|███       | 1240/4000 [00:19<00:41, 66.66it/s]Training:  31%|███       | 1247/4000 [00:19<00:41, 66.66it/s]Training:  31%|███▏      | 1254/4000 [00:19<00:41, 66.83it/s]Training:  32%|███▏      | 1261/4000 [00:19<00:40, 66.99it/s]Training:  32%|███▏      | 1268/4000 [00:19<00:40, 66.88it/s]Training:  32%|███▏      | 1275/4000 [00:19<00:40, 66.85it/s]Training:  32%|███▏      | 1282/4000 [00:19<00:40, 66.79it/s]Training:  32%|███▏      | 1289/4000 [00:19<00:40, 66.79it/s]Training:  32%|███▏      | 1296/4000 [00:20<00:40, 66.75it/s]Training:  33%|███▎      | 1303/4000 [00:20<00:40, 66.87it/s]Training:  33%|███▎      | 1310/4000 [00:20<00:40, 66.95it/s]Training:  33%|███▎      | 1317/4000 [00:20<00:40, 67.06it/s]Training:  33%|███▎      | 1324/4000 [00:20<00:40, 66.86it/s]Training:  33%|███▎      | 1331/4000 [00:20<00:39, 66.75it/s]Training:  33%|███▎      | 1338/4000 [00:20<00:39, 66.96it/s]Training:  34%|███▎      | 1345/4000 [00:20<00:39, 66.74it/s]Training:  34%|███▍      | 1352/4000 [00:20<00:41, 64.49it/s]Training:  34%|███▍      | 1359/4000 [00:21<00:40, 64.90it/s]Training:  34%|███▍      | 1366/4000 [00:21<00:40, 65.42it/s]Training:  34%|███▍      | 1373/4000 [00:21<00:39, 65.90it/s]Training:  34%|███▍      | 1380/4000 [00:21<00:39, 66.07it/s]Training:  35%|███▍      | 1387/4000 [00:21<00:39, 66.25it/s]Training:  35%|███▍      | 1394/4000 [00:21<00:39, 66.42it/s]Training:  35%|███▌      | 1401/4000 [00:21<00:39, 66.61it/s]Training:  35%|███▌      | 1408/4000 [00:21<00:38, 66.60it/s]Training:  35%|███▌      | 1415/4000 [00:21<00:38, 66.62it/s]Training:  36%|███▌      | 1422/4000 [00:21<00:38, 66.68it/s]Training:  36%|███▌      | 1429/4000 [00:22<00:38, 66.80it/s]Training:  36%|███▌      | 1436/4000 [00:22<00:38, 67.02it/s]Training:  36%|███▌      | 1443/4000 [00:22<00:38, 66.87it/s]Training:  36%|███▋      | 1450/4000 [00:22<00:38, 66.65it/s]Training:  36%|███▋      | 1457/4000 [00:22<00:38, 66.63it/s]Training:  37%|███▋      | 1464/4000 [00:22<00:38, 66.66it/s]Training:  37%|███▋      | 1471/4000 [00:22<00:37, 66.62it/s]Training:  37%|███▋      | 1478/4000 [00:22<00:37, 66.61it/s]Training:  37%|███▋      | 1485/4000 [00:22<00:37, 66.49it/s]Training:  37%|███▋      | 1492/4000 [00:22<00:37, 66.70it/s]Training:  37%|███▋      | 1499/4000 [00:23<00:37, 66.78it/s]Training:  38%|███▊      | 1506/4000 [00:23<00:37, 66.91it/s]Training:  38%|███▊      | 1513/4000 [00:23<00:37, 66.80it/s]Training:  38%|███▊      | 1520/4000 [00:23<00:37, 66.86it/s]Training:  38%|███▊      | 1527/4000 [00:23<00:37, 66.72it/s]Training:  38%|███▊      | 1534/4000 [00:23<00:36, 66.67it/s]Training:  39%|███▊      | 1541/4000 [00:23<00:36, 66.69it/s]Training:  39%|███▊      | 1548/4000 [00:23<00:36, 66.72it/s]Training:  39%|███▉      | 1555/4000 [00:23<00:36, 66.71it/s]Training:  39%|███▉      | 1562/4000 [00:24<00:36, 66.70it/s]Training:  39%|███▉      | 1569/4000 [00:24<00:36, 66.01it/s]Training:  39%|███▉      | 1576/4000 [00:24<00:36, 66.08it/s]Training:  40%|███▉      | 1583/4000 [00:24<00:36, 66.32it/s]Training:  40%|███▉      | 1590/4000 [00:24<00:36, 66.38it/s]Training:  40%|███▉      | 1597/4000 [00:24<00:36, 66.62it/s]Training:  40%|████      | 1604/4000 [00:24<00:35, 66.85it/s]Training:  40%|████      | 1611/4000 [00:24<00:35, 66.76it/s]Training:  40%|████      | 1618/4000 [00:24<00:35, 67.04it/s]Training:  41%|████      | 1625/4000 [00:24<00:35, 67.04it/s]Training:  41%|████      | 1632/4000 [00:25<00:35, 66.78it/s]Training:  41%|████      | 1639/4000 [00:25<00:35, 66.74it/s]Training:  41%|████      | 1646/4000 [00:25<00:35, 66.72it/s]Training:  41%|████▏     | 1653/4000 [00:25<00:35, 66.88it/s]Training:  42%|████▏     | 1660/4000 [00:25<00:35, 66.85it/s]Training:  42%|████▏     | 1667/4000 [00:25<00:34, 66.86it/s]Training:  42%|████▏     | 1674/4000 [00:25<00:34, 66.82it/s]Training:  42%|████▏     | 1681/4000 [00:25<00:34, 66.78it/s]Training:  42%|████▏     | 1688/4000 [00:25<00:34, 66.71it/s]Training:  42%|████▏     | 1695/4000 [00:26<00:34, 66.56it/s]Training:  43%|████▎     | 1702/4000 [00:26<00:34, 66.49it/s]Training:  43%|████▎     | 1709/4000 [00:26<00:34, 66.54it/s]Training:  43%|████▎     | 1716/4000 [00:26<00:34, 66.57it/s]Training:  43%|████▎     | 1723/4000 [00:26<00:34, 66.59it/s]Training:  43%|████▎     | 1730/4000 [00:26<00:34, 66.70it/s]Training:  43%|████▎     | 1737/4000 [00:26<00:33, 66.71it/s]Training:  44%|████▎     | 1744/4000 [00:26<00:33, 66.65it/s]Training:  44%|████▍     | 1751/4000 [00:26<00:33, 66.66it/s]Training:  44%|████▍     | 1758/4000 [00:26<00:33, 66.78it/s]Training:  44%|████▍     | 1765/4000 [00:27<00:33, 66.74it/s]Training:  44%|████▍     | 1772/4000 [00:27<00:33, 66.72it/s]Training:  44%|████▍     | 1779/4000 [00:27<00:33, 66.91it/s]Training:  45%|████▍     | 1786/4000 [00:27<00:33, 66.79it/s]Training:  45%|████▍     | 1793/4000 [00:27<00:33, 66.78it/s]Training:  45%|████▌     | 1801/4000 [00:27<00:32, 67.81it/s]Training:  45%|████▌     | 1808/4000 [00:27<00:32, 67.47it/s]Training:  45%|████▌     | 1816/4000 [00:27<00:31, 68.67it/s]Training:  46%|████▌     | 1824/4000 [00:27<00:31, 69.35it/s]Training:  46%|████▌     | 1831/4000 [00:28<00:31, 69.15it/s]Training:  46%|████▌     | 1838/4000 [00:28<00:31, 68.87it/s]Training:  46%|████▌     | 1845/4000 [00:28<00:31, 68.84it/s]Training:  46%|████▋     | 1852/4000 [00:28<00:31, 68.68it/s]Training:  46%|████▋     | 1859/4000 [00:28<00:31, 68.55it/s]Training:  47%|████▋     | 1866/4000 [00:28<00:31, 68.54it/s]Training:  47%|████▋     | 1873/4000 [00:28<00:30, 68.67it/s]Training:  47%|████▋     | 1880/4000 [00:28<00:30, 68.59it/s]Training:  47%|████▋     | 1887/4000 [00:28<00:30, 68.66it/s]Training:  47%|████▋     | 1894/4000 [00:28<00:30, 68.77it/s]Training:  48%|████▊     | 1901/4000 [00:29<00:30, 68.81it/s]Training:  48%|████▊     | 1908/4000 [00:29<00:30, 68.79it/s]Training:  48%|████▊     | 1915/4000 [00:29<00:30, 68.59it/s]Training:  48%|████▊     | 1922/4000 [00:29<00:30, 68.72it/s]Training:  48%|████▊     | 1929/4000 [00:29<00:30, 68.73it/s]Training:  48%|████▊     | 1936/4000 [00:29<00:30, 68.70it/s]Training:  49%|████▊     | 1943/4000 [00:29<00:29, 68.75it/s]Training:  49%|████▉     | 1950/4000 [00:29<00:29, 68.64it/s]Training:  49%|████▉     | 1957/4000 [00:29<00:29, 68.55it/s]Training:  49%|████▉     | 1964/4000 [00:29<00:29, 68.48it/s]Training:  49%|████▉     | 1971/4000 [00:30<00:29, 68.62it/s]Training:  49%|████▉     | 1978/4000 [00:30<00:29, 68.67it/s]Training:  50%|████▉     | 1985/4000 [00:30<00:29, 68.58it/s]Training:  50%|████▉     | 1992/4000 [00:30<00:29, 68.41it/s]Training:  50%|████▉     | 1999/4000 [00:30<00:29, 68.52it/s]Training:  50%|█████     | 2006/4000 [00:30<00:29, 68.59it/s]Training:  50%|█████     | 2013/4000 [00:30<00:28, 68.66it/s]Training:  50%|█████     | 2020/4000 [00:30<00:28, 68.55it/s]Training:  51%|█████     | 2027/4000 [00:30<00:28, 68.51it/s]Training:  51%|█████     | 2034/4000 [00:31<00:28, 68.55it/s]Training:  51%|█████     | 2041/4000 [00:31<00:28, 68.54it/s]Training:  51%|█████     | 2048/4000 [00:31<00:28, 68.54it/s]Training:  51%|█████▏    | 2055/4000 [00:31<00:28, 68.77it/s]Training:  52%|█████▏    | 2062/4000 [00:31<00:28, 68.66it/s]Training:  52%|█████▏    | 2069/4000 [00:31<00:28, 68.55it/s]Training:  52%|█████▏    | 2076/4000 [00:31<00:27, 68.82it/s]Training:  52%|█████▏    | 2083/4000 [00:31<00:27, 68.86it/s]Training:  52%|█████▏    | 2091/4000 [00:31<00:26, 71.88it/s]Training:  52%|█████▏    | 2099/4000 [00:31<00:25, 73.15it/s]Training:  53%|█████▎    | 2107/4000 [00:32<00:26, 71.70it/s]Training:  53%|█████▎    | 2115/4000 [00:32<00:26, 70.60it/s]Training:  53%|█████▎    | 2123/4000 [00:32<00:26, 70.08it/s]Training:  53%|█████▎    | 2131/4000 [00:32<00:26, 69.57it/s]Training:  53%|█████▎    | 2138/4000 [00:32<00:26, 69.58it/s]Training:  54%|█████▎    | 2145/4000 [00:32<00:26, 69.65it/s]Training:  54%|█████▍    | 2152/4000 [00:32<00:26, 69.68it/s]Training:  54%|█████▍    | 2159/4000 [00:32<00:26, 69.34it/s]Training:  54%|█████▍    | 2166/4000 [00:32<00:26, 69.24it/s]Training:  54%|█████▍    | 2173/4000 [00:33<00:26, 69.14it/s]Training:  55%|█████▍    | 2180/4000 [00:33<00:26, 69.06it/s]Training:  55%|█████▍    | 2187/4000 [00:33<00:26, 68.99it/s]Training:  55%|█████▍    | 2194/4000 [00:33<00:26, 69.03it/s]Training:  55%|█████▌    | 2201/4000 [00:33<00:26, 68.74it/s]Training:  55%|█████▌    | 2208/4000 [00:33<00:26, 68.75it/s]Training:  55%|█████▌    | 2215/4000 [00:33<00:25, 68.73it/s]Training:  56%|█████▌    | 2222/4000 [00:33<00:25, 68.75it/s]Training:  56%|█████▌    | 2229/4000 [00:33<00:25, 68.68it/s]Training:  56%|█████▌    | 2236/4000 [00:33<00:25, 68.68it/s]Training:  56%|█████▌    | 2243/4000 [00:34<00:25, 68.54it/s]Training:  56%|█████▋    | 2250/4000 [00:34<00:25, 68.62it/s]Training:  56%|█████▋    | 2257/4000 [00:34<00:25, 68.58it/s]Training:  57%|█████▋    | 2264/4000 [00:34<00:25, 68.61it/s]Training:  57%|█████▋    | 2271/4000 [00:34<00:25, 68.63it/s]Training:  57%|█████▋    | 2278/4000 [00:34<00:25, 68.55it/s]Training:  57%|█████▋    | 2285/4000 [00:34<00:24, 68.71it/s]Training:  57%|█████▋    | 2292/4000 [00:34<00:24, 68.81it/s]Training:  57%|█████▋    | 2299/4000 [00:34<00:24, 68.66it/s]Training:  58%|█████▊    | 2306/4000 [00:34<00:24, 68.41it/s]Training:  58%|█████▊    | 2313/4000 [00:35<00:24, 68.42it/s]Training:  58%|█████▊    | 2320/4000 [00:35<00:24, 68.48it/s]Training:  58%|█████▊    | 2327/4000 [00:35<00:24, 68.48it/s]Training:  58%|█████▊    | 2334/4000 [00:35<00:24, 68.66it/s]Training:  59%|█████▊    | 2341/4000 [00:35<00:24, 68.78it/s]Training:  59%|█████▊    | 2348/4000 [00:35<00:24, 68.79it/s]Training:  59%|█████▉    | 2355/4000 [00:35<00:23, 68.65it/s]Training:  59%|█████▉    | 2362/4000 [00:35<00:23, 68.63it/s]Training:  59%|█████▉    | 2369/4000 [00:35<00:23, 68.89it/s]Training:  59%|█████▉    | 2376/4000 [00:35<00:23, 69.09it/s]Training:  60%|█████▉    | 2383/4000 [00:36<00:23, 69.16it/s]Training:  60%|█████▉    | 2390/4000 [00:36<00:23, 69.32it/s]Training:  60%|█████▉    | 2397/4000 [00:36<00:23, 69.06it/s]Training:  60%|██████    | 2404/4000 [00:36<00:23, 68.88it/s]Training:  60%|██████    | 2411/4000 [00:36<00:23, 68.84it/s]Training:  60%|██████    | 2418/4000 [00:36<00:22, 68.92it/s]Training:  61%|██████    | 2425/4000 [00:36<00:26, 60.17it/s]Training:  61%|██████    | 2432/4000 [00:36<00:25, 62.47it/s]Training:  61%|██████    | 2439/4000 [00:36<00:24, 64.19it/s]Training:  61%|██████    | 2446/4000 [00:37<00:23, 65.34it/s]Training:  61%|██████▏   | 2453/4000 [00:37<00:23, 66.40it/s]Training:  62%|██████▏   | 2460/4000 [00:37<00:22, 67.02it/s]Training:  62%|██████▏   | 2467/4000 [00:37<00:22, 67.59it/s]Training:  62%|██████▏   | 2474/4000 [00:37<00:22, 67.88it/s]Training:  62%|██████▏   | 2481/4000 [00:37<00:22, 68.17it/s]Training:  62%|██████▏   | 2488/4000 [00:37<00:22, 68.46it/s]Training:  62%|██████▏   | 2495/4000 [00:37<00:22, 68.38it/s]Training:  63%|██████▎   | 2502/4000 [00:37<00:21, 68.44it/s]Training:  63%|██████▎   | 2509/4000 [00:37<00:21, 68.68it/s]Training:  63%|██████▎   | 2516/4000 [00:38<00:21, 68.67it/s]Training:  63%|██████▎   | 2523/4000 [00:38<00:21, 68.48it/s]Training:  63%|██████▎   | 2530/4000 [00:38<00:21, 68.53it/s]Training:  63%|██████▎   | 2537/4000 [00:38<00:21, 68.52it/s]Training:  64%|██████▎   | 2544/4000 [00:38<00:21, 68.59it/s]Training:  64%|██████▍   | 2551/4000 [00:38<00:21, 68.60it/s]Training:  64%|██████▍   | 2558/4000 [00:38<00:21, 68.51it/s]Training:  64%|██████▍   | 2565/4000 [00:38<00:20, 68.64it/s]Training:  64%|██████▍   | 2572/4000 [00:38<00:20, 68.69it/s]Training:  64%|██████▍   | 2579/4000 [00:38<00:20, 68.67it/s]Training:  65%|██████▍   | 2586/4000 [00:39<00:20, 68.61it/s]Training:  65%|██████▍   | 2593/4000 [00:39<00:20, 68.70it/s]Training:  65%|██████▌   | 2600/4000 [00:39<00:20, 68.67it/s]Training:  65%|██████▌   | 2607/4000 [00:39<00:20, 68.65it/s]Training:  65%|██████▌   | 2614/4000 [00:39<00:20, 68.63it/s]Training:  66%|██████▌   | 2621/4000 [00:39<00:20, 68.54it/s]Training:  66%|██████▌   | 2628/4000 [00:39<00:20, 68.57it/s]Training:  66%|██████▌   | 2635/4000 [00:39<00:19, 68.56it/s]Training:  66%|██████▌   | 2642/4000 [00:39<00:19, 68.59it/s]Training:  66%|██████▌   | 2649/4000 [00:39<00:19, 68.39it/s]Training:  66%|██████▋   | 2656/4000 [00:40<00:19, 68.38it/s]Training:  67%|██████▋   | 2663/4000 [00:40<00:19, 68.25it/s]Training:  67%|██████▋   | 2670/4000 [00:40<00:19, 68.26it/s]Training:  67%|██████▋   | 2677/4000 [00:40<00:19, 68.14it/s]Training:  67%|██████▋   | 2684/4000 [00:40<00:19, 68.20it/s]Training:  67%|██████▋   | 2691/4000 [00:40<00:19, 68.09it/s]Training:  67%|██████▋   | 2698/4000 [00:40<00:19, 68.02it/s]Training:  68%|██████▊   | 2705/4000 [00:40<00:19, 67.97it/s]Training:  68%|██████▊   | 2712/4000 [00:40<00:18, 68.18it/s]Training:  68%|██████▊   | 2719/4000 [00:41<00:18, 68.39it/s]Training:  68%|██████▊   | 2726/4000 [00:41<00:18, 68.32it/s]Training:  68%|██████▊   | 2733/4000 [00:41<00:18, 68.13it/s]Training:  68%|██████▊   | 2740/4000 [00:41<00:18, 68.14it/s]Training:  69%|██████▊   | 2747/4000 [00:41<00:18, 68.25it/s]Training:  69%|██████▉   | 2754/4000 [00:41<00:18, 68.09it/s]Training:  69%|██████▉   | 2761/4000 [00:41<00:18, 68.12it/s]Training:  69%|██████▉   | 2768/4000 [00:41<00:18, 67.89it/s]Training:  69%|██████▉   | 2775/4000 [00:41<00:18, 67.99it/s]Training:  70%|██████▉   | 2782/4000 [00:41<00:17, 68.12it/s]Training:  70%|██████▉   | 2789/4000 [00:42<00:17, 68.23it/s]Training:  70%|██████▉   | 2796/4000 [00:42<00:17, 68.20it/s]Training:  70%|███████   | 2803/4000 [00:42<00:17, 68.11it/s]Training:  70%|███████   | 2810/4000 [00:42<00:17, 68.09it/s]Training:  70%|███████   | 2817/4000 [00:42<00:17, 68.07it/s]Training:  71%|███████   | 2824/4000 [00:42<00:17, 67.98it/s]Training:  71%|███████   | 2831/4000 [00:42<00:17, 67.98it/s]Training:  71%|███████   | 2838/4000 [00:42<00:17, 68.11it/s]Training:  71%|███████   | 2845/4000 [00:42<00:16, 68.13it/s]Training:  71%|███████▏  | 2852/4000 [00:42<00:16, 68.25it/s]Training:  71%|███████▏  | 2859/4000 [00:43<00:16, 68.20it/s]Training:  72%|███████▏  | 2866/4000 [00:43<00:16, 68.26it/s]Training:  72%|███████▏  | 2873/4000 [00:43<00:16, 68.42it/s]Training:  72%|███████▏  | 2880/4000 [00:43<00:16, 68.46it/s]Training:  72%|███████▏  | 2887/4000 [00:43<00:16, 68.37it/s]Training:  72%|███████▏  | 2894/4000 [00:43<00:16, 68.47it/s]Training:  73%|███████▎  | 2901/4000 [00:43<00:16, 68.49it/s]Training:  73%|███████▎  | 2908/4000 [00:43<00:15, 68.35it/s]Training:  73%|███████▎  | 2915/4000 [00:43<00:15, 68.31it/s]Training:  73%|███████▎  | 2922/4000 [00:43<00:15, 68.30it/s]Training:  73%|███████▎  | 2929/4000 [00:44<00:15, 68.28it/s]Training:  73%|███████▎  | 2936/4000 [00:44<00:15, 68.35it/s]Training:  74%|███████▎  | 2943/4000 [00:44<00:15, 68.15it/s]Training:  74%|███████▍  | 2950/4000 [00:44<00:15, 68.15it/s]Training:  74%|███████▍  | 2957/4000 [00:44<00:15, 68.13it/s]Training:  74%|███████▍  | 2964/4000 [00:44<00:15, 68.03it/s]Training:  74%|███████▍  | 2971/4000 [00:44<00:15, 67.88it/s]Training:  74%|███████▍  | 2978/4000 [00:44<00:15, 68.00it/s]Training:  75%|███████▍  | 2985/4000 [00:44<00:14, 67.99it/s]Training:  75%|███████▍  | 2992/4000 [00:45<00:14, 68.17it/s]Training:  75%|███████▍  | 2999/4000 [00:45<00:14, 68.29it/s]Training:  75%|███████▌  | 3006/4000 [00:45<00:14, 68.25it/s]Training:  75%|███████▌  | 3013/4000 [00:45<00:14, 68.39it/s]Training:  76%|███████▌  | 3020/4000 [00:45<00:14, 68.22it/s]Training:  76%|███████▌  | 3027/4000 [00:45<00:14, 68.36it/s]Training:  76%|███████▌  | 3034/4000 [00:45<00:14, 68.35it/s]Training:  76%|███████▌  | 3041/4000 [00:45<00:14, 68.42it/s]Training:  76%|███████▌  | 3048/4000 [00:45<00:13, 68.26it/s]Training:  76%|███████▋  | 3055/4000 [00:45<00:13, 68.47it/s]Training:  77%|███████▋  | 3062/4000 [00:46<00:13, 68.65it/s]Training:  77%|███████▋  | 3069/4000 [00:46<00:13, 68.52it/s]Training:  77%|███████▋  | 3076/4000 [00:46<00:13, 68.41it/s]Training:  77%|███████▋  | 3083/4000 [00:46<00:13, 68.27it/s]Training:  77%|███████▋  | 3090/4000 [00:46<00:13, 68.37it/s]Training:  77%|███████▋  | 3097/4000 [00:46<00:13, 68.37it/s]Training:  78%|███████▊  | 3104/4000 [00:46<00:13, 68.41it/s]Training:  78%|███████▊  | 3111/4000 [00:46<00:13, 68.37it/s]Training:  78%|███████▊  | 3118/4000 [00:46<00:12, 68.37it/s]Training:  78%|███████▊  | 3125/4000 [00:46<00:12, 68.28it/s]Training:  78%|███████▊  | 3132/4000 [00:47<00:12, 68.25it/s]Training:  78%|███████▊  | 3139/4000 [00:47<00:12, 68.28it/s]Training:  79%|███████▊  | 3146/4000 [00:47<00:12, 68.28it/s]Training:  79%|███████▉  | 3153/4000 [00:47<00:12, 68.34it/s]Training:  79%|███████▉  | 3160/4000 [00:47<00:12, 68.41it/s]Training:  79%|███████▉  | 3167/4000 [00:47<00:12, 68.32it/s]Training:  79%|███████▉  | 3174/4000 [00:47<00:12, 68.29it/s]Training:  80%|███████▉  | 3181/4000 [00:47<00:11, 68.28it/s]Training:  80%|███████▉  | 3188/4000 [00:47<00:11, 68.20it/s]Training:  80%|███████▉  | 3195/4000 [00:47<00:11, 68.37it/s]Training:  80%|████████  | 3202/4000 [00:48<00:11, 68.45it/s]Training:  80%|████████  | 3209/4000 [00:48<00:11, 68.27it/s]Training:  80%|████████  | 3216/4000 [00:48<00:11, 68.34it/s]Training:  81%|████████  | 3223/4000 [00:48<00:11, 68.24it/s]Training:  81%|████████  | 3230/4000 [00:48<00:11, 68.22it/s]Training:  81%|████████  | 3237/4000 [00:48<00:11, 68.40it/s]Training:  81%|████████  | 3244/4000 [00:48<00:11, 68.33it/s]Training:  81%|████████▏ | 3251/4000 [00:48<00:10, 68.41it/s]Training:  81%|████████▏ | 3258/4000 [00:48<00:10, 68.37it/s]Training:  82%|████████▏ | 3265/4000 [00:49<00:10, 68.42it/s]Training:  82%|████████▏ | 3272/4000 [00:49<00:10, 68.53it/s]Training:  82%|████████▏ | 3279/4000 [00:49<00:10, 68.58it/s]Training:  82%|████████▏ | 3286/4000 [00:49<00:10, 68.47it/s]Training:  82%|████████▏ | 3293/4000 [00:49<00:10, 68.51it/s]Training:  82%|████████▎ | 3300/4000 [00:49<00:10, 68.52it/s]Training:  83%|████████▎ | 3307/4000 [00:49<00:10, 68.39it/s]Training:  83%|████████▎ | 3314/4000 [00:49<00:10, 68.27it/s]Training:  83%|████████▎ | 3321/4000 [00:49<00:09, 68.23it/s]Training:  83%|████████▎ | 3328/4000 [00:49<00:09, 68.18it/s]Training:  83%|████████▎ | 3335/4000 [00:50<00:09, 68.50it/s]Training:  84%|████████▎ | 3342/4000 [00:50<00:09, 68.65it/s]Training:  84%|████████▎ | 3349/4000 [00:50<00:09, 68.47it/s]Training:  84%|████████▍ | 3356/4000 [00:50<00:09, 68.34it/s]Training:  84%|████████▍ | 3363/4000 [00:50<00:09, 68.35it/s]Training:  84%|████████▍ | 3370/4000 [00:50<00:09, 68.32it/s]Training:  84%|████████▍ | 3377/4000 [00:50<00:09, 68.46it/s]Training:  85%|████████▍ | 3384/4000 [00:50<00:09, 68.35it/s]Training:  85%|████████▍ | 3391/4000 [00:50<00:08, 68.47it/s]Training:  85%|████████▍ | 3398/4000 [00:50<00:08, 68.51it/s]Training:  85%|████████▌ | 3405/4000 [00:51<00:08, 68.52it/s]Training:  85%|████████▌ | 3412/4000 [00:51<00:08, 68.31it/s]Training:  85%|████████▌ | 3419/4000 [00:51<00:08, 68.49it/s]Training:  86%|████████▌ | 3426/4000 [00:51<00:08, 68.49it/s]Training:  86%|████████▌ | 3433/4000 [00:51<00:08, 68.31it/s]Training:  86%|████████▌ | 3440/4000 [00:51<00:08, 68.31it/s]Training:  86%|████████▌ | 3447/4000 [00:51<00:08, 68.28it/s]Training:  86%|████████▋ | 3454/4000 [00:51<00:07, 68.39it/s]Training:  87%|████████▋ | 3461/4000 [00:51<00:07, 68.49it/s]Training:  87%|████████▋ | 3468/4000 [00:51<00:07, 68.44it/s]Training:  87%|████████▋ | 3475/4000 [00:52<00:07, 68.35it/s]Training:  87%|████████▋ | 3482/4000 [00:52<00:07, 68.21it/s]Training:  87%|████████▋ | 3489/4000 [00:52<00:07, 68.17it/s]Training:  87%|████████▋ | 3496/4000 [00:52<00:07, 68.24it/s]Training:  88%|████████▊ | 3503/4000 [00:52<00:07, 68.33it/s]Training:  88%|████████▊ | 3510/4000 [00:52<00:07, 68.22it/s]Training:  88%|████████▊ | 3517/4000 [00:52<00:07, 68.28it/s]Training:  88%|████████▊ | 3524/4000 [00:52<00:06, 68.33it/s]Training:  88%|████████▊ | 3531/4000 [00:52<00:06, 68.37it/s]Training:  88%|████████▊ | 3538/4000 [00:53<00:06, 68.30it/s]Training:  89%|████████▊ | 3545/4000 [00:53<00:06, 68.36it/s]Training:  89%|████████▉ | 3552/4000 [00:53<00:06, 68.33it/s]Training:  89%|████████▉ | 3559/4000 [00:53<00:06, 68.27it/s]Training:  89%|████████▉ | 3566/4000 [00:53<00:06, 68.35it/s]Training:  89%|████████▉ | 3573/4000 [00:53<00:06, 68.30it/s]Training:  90%|████████▉ | 3580/4000 [00:53<00:06, 68.39it/s]Training:  90%|████████▉ | 3587/4000 [00:53<00:06, 68.45it/s]Training:  90%|████████▉ | 3594/4000 [00:53<00:05, 68.54it/s]Training:  90%|█████████ | 3601/4000 [00:53<00:05, 68.59it/s]Training:  90%|█████████ | 3609/4000 [00:54<00:05, 71.82it/s]Training:  90%|█████████ | 3619/4000 [00:54<00:04, 78.50it/s]Training:  91%|█████████ | 3629/4000 [00:54<00:04, 82.99it/s]Training:  91%|█████████ | 3639/4000 [00:54<00:04, 85.99it/s]Training:  91%|█████████ | 3649/4000 [00:54<00:03, 88.08it/s]Training:  91%|█████████▏| 3659/4000 [00:54<00:03, 89.66it/s]Training:  92%|█████████▏| 3669/4000 [00:54<00:03, 90.86it/s]Training:  92%|█████████▏| 3679/4000 [00:54<00:03, 91.60it/s]Training:  92%|█████████▏| 3689/4000 [00:54<00:03, 92.11it/s]Training:  92%|█████████▏| 3699/4000 [00:54<00:03, 92.45it/s]Training:  93%|█████████▎| 3709/4000 [00:55<00:03, 92.63it/s]Training:  93%|█████████▎| 3719/4000 [00:55<00:03, 92.88it/s]Training:  93%|█████████▎| 3729/4000 [00:55<00:02, 93.15it/s]Training:  93%|█████████▎| 3739/4000 [00:55<00:02, 93.23it/s]Training:  94%|█████████▎| 3749/4000 [00:55<00:02, 93.19it/s]Training:  94%|█████████▍| 3759/4000 [00:55<00:02, 93.28it/s]Training:  94%|█████████▍| 3769/4000 [00:55<00:02, 93.13it/s]Training:  94%|█████████▍| 3779/4000 [00:55<00:02, 93.14it/s]Training:  95%|█████████▍| 3789/4000 [00:55<00:02, 93.09it/s]Training:  95%|█████████▍| 3799/4000 [00:56<00:02, 93.34it/s]Training:  95%|█████████▌| 3809/4000 [00:56<00:02, 93.15it/s]Training:  96%|█████████▌| 3821/4000 [00:56<00:01, 100.26it/s]Training:  96%|█████████▌| 3834/4000 [00:56<00:01, 108.21it/s]Training:  96%|█████████▌| 3845/4000 [00:56<00:01, 104.60it/s]Training:  96%|█████████▋| 3856/4000 [00:56<00:01, 100.20it/s]Training:  97%|█████████▋| 3867/4000 [00:56<00:01, 97.30it/s] Training:  97%|█████████▋| 3877/4000 [00:56<00:01, 95.44it/s]Training:  97%|█████████▋| 3887/4000 [00:56<00:01, 94.15it/s]Training:  97%|█████████▋| 3897/4000 [00:57<00:01, 93.37it/s]Training:  98%|█████████▊| 3907/4000 [00:57<00:01, 92.61it/s]Training:  98%|█████████▊| 3917/4000 [00:57<00:00, 92.08it/s]Training:  98%|█████████▊| 3927/4000 [00:57<00:00, 91.82it/s]Training:  98%|█████████▊| 3937/4000 [00:57<00:00, 91.72it/s]Training:  99%|█████████▊| 3947/4000 [00:57<00:00, 91.50it/s]Training:  99%|█████████▉| 3957/4000 [00:57<00:00, 91.28it/s]Training:  99%|█████████▉| 3967/4000 [00:57<00:00, 91.36it/s]Training:  99%|█████████▉| 3977/4000 [00:57<00:00, 91.35it/s]Training: 100%|█████████▉| 3987/4000 [00:58<00:00, 91.24it/s]Training: 100%|█████████▉| 3997/4000 [00:58<00:00, 91.24it/s]Training: 100%|██████████| 4000/4000 [00:58<00:00, 68.74it/s]
[0.8274596  0.8203519  0.8104113  ... 0.94769233 0.94943905 0.95050746]
Assigning cell types:   0%|          | 0/1203 [00:00<?, ?it/s]Assigning cell types:  29%|██▉       | 353/1203 [00:00<00:00, 3521.46it/s]Assigning cell types:  60%|██████    | 726/1203 [00:00<00:00, 3643.73it/s]Assigning cell types:  91%|█████████▏| 1100/1203 [00:00<00:00, 3686.39it/s]Assigning cell types: 100%|██████████| 1203/1203 [00:00<00:00, 3673.28it/s]
match
True     24945
False     2121
Name: count, dtype: int64 0.9216360008867214
SPOT_0_35 -2.0 43 45.0 [ 1.  1.  1. 41.  1.]
SPOT_0_35 0.0 43 45.0 [ 0.  0.  1. 41.  1.]
SPOT_0_38 -2.0 46 48.0 [ 1.  1.  1. 44.  1.]
SPOT_0_38 0.0 46 48.0 [ 0.  0.  1. 44.  1.]
SPOT_0_44 -2.0 47 49.0 [ 1.  1.  1. 45.  1.]
SPOT_0_44 0.0 47 49.0 [ 0.  0.  1. 45.  1.]
SPOT_0_46 -1.0 42 43.0 [ 0.  1.  1. 40.  1.]
SPOT_0_46 0.0 42 43.0 [ 0.  0.  1. 40.  1.]
SPOT_1_44 -1.0 43 44.0 [ 0.  1.  1. 41.  1.]
SPOT_1_44 0.0 43 44.0 [ 0.  0.  1. 41.  1.]
SPOT_2_15 -1.0 44 45.0 [ 0.  1.  1. 42.  1.]
SPOT_2_15 0.0 44 45.0 [ 0.  0.  1. 42.  1.]
SPOT_2_16 -1.0 57 58.0 [ 1.  1.  1. 54.  1.]
SPOT_2_16 0.0 57 58.0 [ 0.  1.  1. 54.  1.]
SPOT_2_40 -1.0 28 29.0 [ 6.  2.  4. 17.  0.]
SPOT_2_40 0.0 28 29.0 [ 6.  1.  4. 17.  0.]
SPOT_2_43 -2.0 45 47.0 [ 1.  1.  1. 43.  1.]
SPOT_2_43 0.0 45 47.0 [ 0.  0.  1. 43.  1.]
SPOT_3_15 -2.0 48 50.0 [ 1.  1.  1. 46.  1.]
SPOT_3_15 0.0 48 50.0 [ 0.  0.  1. 46.  1.]
SPOT_3_17 -1.0 55 56.0 [ 5.  1.  1. 48.  1.]
SPOT_3_17 0.0 55 56.0 [ 5.  0.  1. 48.  1.]
SPOT_3_26 -1.0 19 20.0 [ 2.  2.  2. 12.  2.]
SPOT_3_26 0.0 19 20.0 [ 1.  2.  2. 12.  2.]
SPOT_3_32 -1.0 16 17.0 [4. 2. 3. 8. 0.]
SPOT_3_32 0.0 16 17.0 [4. 1. 3. 8. 0.]
SPOT_4_20 -1.0 43 44.0 [ 1.  1.  1. 41.  0.]
SPOT_4_20 0.0 43 44.0 [ 0.  1.  1. 41.  0.]
SPOT_4_30 -1.0 16 17.0 [5. 0. 0. 6. 6.]
SPOT_4_30 0.0 16 17.0 [4. 0. 0. 6. 6.]
SPOT_4_33 -1.0 13 14.0 [0. 3. 7. 4. 0.]
SPOT_4_33 0.0 13 14.0 [0. 2. 7. 4. 0.]
SPOT_4_39 -1.0 56 57.0 [ 1.  1.  1. 53.  1.]
SPOT_4_39 0.0 56 57.0 [ 0.  1.  1. 53.  1.]
SPOT_5_16 -1.0 52 53.0 [ 3.  1.  3. 45.  1.]
SPOT_5_16 0.0 52 53.0 [ 3.  0.  3. 45.  1.]
SPOT_6_0 -1.0 12 13.0 [3. 0. 2. 6. 2.]
SPOT_6_0 0.0 12 13.0 [3. 0. 1. 6. 2.]
SPOT_6_16 -2.0 45 47.0 [ 1.  1.  1. 43.  1.]
SPOT_6_16 0.0 45 47.0 [ 0.  0.  1. 43.  1.]
SPOT_6_18 -2.0 46 48.0 [ 1.  1.  1. 44.  1.]
SPOT_6_18 0.0 46 48.0 [ 0.  0.  1. 44.  1.]
SPOT_6_19 -2.0 45 47.0 [ 1.  1.  1. 43.  1.]
SPOT_6_19 0.0 45 47.0 [ 0.  0.  1. 43.  1.]
SPOT_6_27 -1.0 16 17.0 [5. 0. 2. 8. 2.]
SPOT_6_27 0.0 16 17.0 [5. 0. 1. 8. 2.]
SPOT_6_43 -1.0 17 18.0 [6. 3. 5. 4. 0.]
SPOT_6_43 0.0 17 18.0 [6. 2. 5. 4. 0.]
SPOT_7_12 -1.0 15 16.0 [2. 2. 2. 8. 2.]
SPOT_7_12 0.0 15 16.0 [1. 2. 2. 8. 2.]
SPOT_8_2 -1.0 17 18.0 [0. 2. 6. 7. 3.]
SPOT_8_2 0.0 17 18.0 [0. 1. 6. 7. 3.]
SPOT_8_14 -1.0 54 55.0 [ 1.  1.  1. 51.  1.]
SPOT_8_14 0.0 54 55.0 [ 0.  1.  1. 51.  1.]
SPOT_8_20 -1.0 43 44.0 [ 0.  1.  1. 41.  1.]
SPOT_8_20 0.0 43 44.0 [ 0.  0.  1. 41.  1.]
SPOT_8_21 -2.0 44 46.0 [ 1.  1.  1. 42.  1.]
SPOT_8_21 0.0 44 46.0 [ 0.  0.  1. 42.  1.]
SPOT_8_34 -1.0 15 16.0 [0. 5. 2. 7. 2.]
SPOT_8_34 0.0 15 16.0 [0. 5. 1. 7. 2.]
SPOT_8_44 -1.0 55 56.0 [ 1.  1.  1. 52.  1.]
SPOT_8_44 0.0 55 56.0 [ 0.  1.  1. 52.  1.]
SPOT_8_45 -1.0 60 61.0 [ 1.  1.  1. 57.  1.]
SPOT_8_45 0.0 60 61.0 [ 0.  1.  1. 57.  1.]
SPOT_9_36 -2.0 42 44.0 [ 1.  1.  1. 40.  1.]
SPOT_9_36 0.0 42 44.0 [ 0.  0.  1. 40.  1.]
SPOT_9_42 -1.0 42 43.0 [ 0.  1.  1. 40.  1.]
SPOT_9_42 0.0 42 43.0 [ 0.  0.  1. 40.  1.]
SPOT_9_44 -1.0 53 54.0 [ 5.  1.  1. 46.  1.]
SPOT_9_44 0.0 53 54.0 [ 5.  0.  1. 46.  1.]
SPOT_10_1 -2.0 50 52.0 [ 3.  1.  5. 42.  1.]
SPOT_10_1 0.0 50 52.0 [ 3.  0.  5. 42.  0.]
SPOT_10_5 -1.0 64 65.0 [ 1.  1.  1. 61.  1.]
SPOT_10_5 0.0 64 65.0 [ 0.  1.  1. 61.  1.]
SPOT_10_6 -1.0 58 59.0 [ 1.  1.  3. 53.  1.]
SPOT_10_6 0.0 58 59.0 [ 0.  1.  3. 53.  1.]
SPOT_10_17 -2.0 49 51.0 [ 1.  1.  1. 47.  1.]
SPOT_10_17 0.0 49 51.0 [ 0.  0.  1. 47.  1.]
SPOT_10_44 -2.0 43 45.0 [ 1.  1.  1. 41.  1.]
SPOT_10_44 0.0 43 45.0 [ 0.  0.  1. 41.  1.]
SPOT_11_0 -2.0 45 47.0 [ 1.  1.  1. 43.  1.]
SPOT_11_0 0.0 45 47.0 [ 0.  0.  1. 43.  1.]
SPOT_11_6 -1.0 60 61.0 [ 1.  1.  1. 53.  5.]
SPOT_11_6 0.0 60 61.0 [ 0.  1.  1. 53.  5.]
SPOT_11_48 -2.0 47 49.0 [ 1.  1.  1. 45.  1.]
SPOT_11_48 0.0 47 49.0 [ 0.  0.  1. 45.  1.]
SPOT_12_14 -2.0 43 45.0 [ 1.  1.  1. 41.  1.]
SPOT_12_14 0.0 43 45.0 [ 0.  0.  1. 41.  1.]
SPOT_12_25 -1.0 12 13.0 [2. 0. 2. 7. 2.]
SPOT_12_25 0.0 12 13.0 [1. 0. 2. 7. 2.]
SPOT_13_0 -1.0 17 18.0 [2. 2. 6. 8. 0.]
SPOT_13_0 0.0 17 18.0 [1. 2. 6. 8. 0.]
SPOT_13_19 -2.0 46 48.0 [ 1.  1.  1. 44.  1.]
SPOT_13_19 0.0 46 48.0 [ 0.  0.  1. 44.  1.]
SPOT_14_17 -1.0 51 52.0 [ 1.  1.  1. 48.  1.]
SPOT_14_17 0.0 51 52.0 [ 0.  1.  1. 48.  1.]
SPOT_14_18 -1.0 53 54.0 [ 1.  1.  1. 50.  1.]
SPOT_14_18 0.0 53 54.0 [ 0.  1.  1. 50.  1.]
SPOT_15_43 -1.0 12 13.0 [4. 0. 2. 7. 0.]
SPOT_15_43 0.0 12 13.0 [4. 0. 1. 7. 0.]
SPOT_16_46 -1.0 24 25.0 [ 7.  0.  2. 14.  2.]
SPOT_16_46 0.0 24 25.0 [ 7.  0.  1. 14.  2.]
SPOT_17_14 -1.0 10 11.0 [3. 0. 6. 2. 0.]
SPOT_17_14 0.0 10 11.0 [3. 0. 6. 1. 0.]
SPOT_17_17 -2.0 46 48.0 [ 1.  1.  1. 44.  1.]
SPOT_17_17 0.0 46 48.0 [ 0.  0.  1. 44.  1.]
SPOT_17_42 -2.0 47 49.0 [ 1.  1.  1. 45.  1.]
SPOT_17_42 0.0 47 49.0 [ 0.  0.  1. 45.  1.]
SPOT_20_14 -2.0 49 51.0 [ 1.  1.  1. 47.  1.]
SPOT_20_14 0.0 49 51.0 [ 0.  0.  1. 47.  1.]
SPOT_20_24 -1.0 10 11.0 [3. 0. 3. 2. 3.]
SPOT_20_24 0.0 10 11.0 [3. 0. 3. 1. 3.]
SPOT_23_15 -2.0 50 52.0 [ 5.  1.  1. 44.  1.]
SPOT_23_15 0.0 50 52.0 [ 5.  0.  0. 44.  1.]
SPOT_24_24 -1.0 17 18.0 [5. 0. 2. 9. 2.]
SPOT_24_24 0.0 17 18.0 [5. 0. 1. 9. 2.]
Assigning cell types...
Assigning cell types:   0%|          | 0/1203 [00:00<?, ?it/s]Assigning cell types:   3%|▎         | 39/1203 [00:00<00:02, 389.20it/s]Assigning cell types:   7%|▋         | 80/1203 [00:00<00:02, 398.64it/s]Assigning cell types:  10%|█         | 121/1203 [00:00<00:02, 401.03it/s]Assigning cell types:  13%|█▎        | 162/1203 [00:00<00:02, 403.26it/s]Assigning cell types:  17%|█▋        | 203/1203 [00:00<00:02, 403.59it/s]Assigning cell types:  20%|██        | 244/1203 [00:00<00:02, 403.52it/s]Assigning cell types:  24%|██▎       | 285/1203 [00:00<00:02, 403.73it/s]Assigning cell types:  27%|██▋       | 326/1203 [00:00<00:02, 401.78it/s]Assigning cell types:  31%|███       | 367/1203 [00:00<00:02, 402.21it/s]Assigning cell types:  34%|███▍      | 408/1203 [00:01<00:01, 403.49it/s]Assigning cell types:  37%|███▋      | 449/1203 [00:01<00:01, 401.36it/s]Assigning cell types:  41%|████      | 490/1203 [00:01<00:01, 399.77it/s]Assigning cell types:  44%|████▍     | 530/1203 [00:01<00:01, 399.41it/s]Assigning cell types:  47%|████▋     | 570/1203 [00:01<00:01, 399.18it/s]Assigning cell types:  51%|█████     | 611/1203 [00:01<00:01, 400.45it/s]Assigning cell types:  54%|█████▍    | 652/1203 [00:01<00:01, 401.75it/s]Assigning cell types:  58%|█████▊    | 693/1203 [00:01<00:01, 401.54it/s]Assigning cell types:  61%|██████    | 734/1203 [00:01<00:01, 401.26it/s]Assigning cell types:  64%|██████▍   | 775/1203 [00:01<00:01, 397.62it/s]Assigning cell types:  68%|██████▊   | 816/1203 [00:02<00:00, 399.78it/s]Assigning cell types:  71%|███████   | 857/1203 [00:02<00:00, 400.96it/s]Assigning cell types:  75%|███████▍  | 898/1203 [00:02<00:00, 402.19it/s]Assigning cell types:  78%|███████▊  | 939/1203 [00:02<00:00, 402.70it/s]Assigning cell types:  81%|████████▏ | 980/1203 [00:02<00:00, 402.42it/s]Assigning cell types:  85%|████████▍ | 1021/1203 [00:02<00:00, 402.95it/s]Assigning cell types:  88%|████████▊ | 1062/1203 [00:02<00:00, 403.36it/s]Assigning cell types:  92%|█████████▏| 1103/1203 [00:02<00:00, 403.94it/s]Assigning cell types:  95%|█████████▌| 1144/1203 [00:02<00:00, 403.04it/s]Assigning cell types:  99%|█████████▊| 1185/1203 [00:02<00:00, 404.27it/s]Assigning cell types: 100%|██████████| 1203/1203 [00:02<00:00, 402.07it/s]
        spot_name     cell_id true_cell_type  ...             y  cell_type match
0        SPOT_0_0  kdnfclga-1          Tumor  ...  10134.285218      Tumor  True
1        SPOT_0_0  kdnfddfd-1          Tumor  ...  10121.761419      Tumor  True
2        SPOT_0_0  kdnfimna-1          Tumor  ...  10165.841206      Tumor  True
3        SPOT_0_0  kdnfmcil-1          Tumor  ...  10194.604531      Tumor  True
4        SPOT_0_0  kdnfocni-1          Tumor  ...  10184.750938      Tumor  True
...           ...         ...            ...  ...           ...        ...   ...
27061  SPOT_25_10  abdaebgm-1          Tumor  ...  12021.306081      Tumor  True
27062  SPOT_25_14  abgpglel-1          Tumor  ...  12816.212020      Tumor  True
27063  SPOT_25_19  gcacponh-1          Tumor  ...  13905.364321      Tumor  True
27064  SPOT_25_24  gfobhfgf-1          Tumor  ...  14812.878338      Tumor  True
27065  SPOT_25_29  bgmpchhj-1          Tumor  ...  15886.603271      Tumor  True

[27066 rows x 7 columns]
match
True     26324
False      742
Name: count, dtype: int64 0.9725855316633415
Constructing SVC adata...
Number of cells processed: 27066
Number of unique spots: 1203
Shape of SVC_X: (27066, 500)
AnnData object with n_obs × n_vars = 27066 × 500
    obs: 'spot_name', 'cell_id', 'true_cell_type', 'x', 'y', 'cell_type', 'match'
500 500 500
Normalizing and log-transforming data.
PCC: 0.7413, 0.9308, 0.4334
SSIM: 0.4227, 0.9204, 0.1877
MSE: 0.2490, 0.5015, 0.0526
NRMSE: 0.5505, 3.7032, 0.0866
Normalizing and log-transforming data.
PCC: 0.7413, 0.9308, 0.4334
SSIM: 0.4128, 0.9204, 0.1330
MSE: 0.0167, 0.0565, 0.0024
NRMSE: 0.6130, 3.7046, 0.0950


PCC: 0.8401, 0.9401, 0.6852
SSIM: 0.7303, 0.9824, 0.3638
MSE: 95.5730, 339.0020, 8.1216
NRMSE: 1.5094, 5.7093, 0.1683
PCC: 0.8401, 0.9401, 0.6852
SSIM: 0.6998, 0.9826, 0.3504
MSE: 0.0094, 0.0819, 0.0013
NRMSE: 1.5830, 5.9206, 0.1731
Finish
