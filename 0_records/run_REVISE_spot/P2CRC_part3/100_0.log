simulation
        spot_name     cell_id true_cell_type             x             y
0        SPOT_0_0  kfacnicf-1          Tumor  60018.732793  10085.500264
1        SPOT_0_0  kfacnmif-1          Tumor  60043.202731  10075.256557
2        SPOT_0_0  kfaeligm-1          Tumor  60089.710572  10010.149937
3        SPOT_0_0  kfaeljkg-1          Tumor  60052.382373  10010.060251
4        SPOT_0_0  kfafmjpi-1          Tumor  60066.498755  10058.876817
...           ...         ...            ...           ...           ...
27061  SPOT_50_20  abdaebgm-1          Tumor  64998.906417  12021.306081
27062  SPOT_50_28  abgpglel-1          Tumor  64999.350144  12816.212020
27063  SPOT_50_39  gcacponh-1          Tumor  64999.642882  13905.364321
27064  SPOT_50_48  gfobhfgf-1          Tumor  64999.818122  14812.878338
27065  SPOT_50_58  bgmpchhj-1          Tumor  64999.282916  15886.603271

[27066 rows x 5 columns]
There are 5 cell types: ['Mono/Macro', 'Plasma', 'T', 'Tumor', 'Vascular EC']
label
Mono/Macro     50
Plasma         50
T              50
Tumor          50
Vascular EC    50
Name: count, dtype: int64
0it [00:00, ?it/s]5it [00:00, 375.40it/s]
0it [00:00, ?it/s]5it [00:00, 338.96it/s]
(5, 250) (5, 500)
Calculating cell contributions and PM_on_cell...
[0.95456845 0.64842474 0.9539838  ... 0.95087004 0.95146805 0.95142305]
Assigning cell types:   0%|          | 0/4569 [00:00<?, ?it/s]Assigning cell types:   8%|▊         | 350/4569 [00:00<00:01, 3493.86it/s]Assigning cell types:  16%|█▌        | 713/4569 [00:00<00:01, 3554.10it/s]Assigning cell types:  24%|██▍       | 1094/4569 [00:00<00:00, 3667.76it/s]Assigning cell types:  33%|███▎      | 1487/4569 [00:00<00:00, 3769.39it/s]Assigning cell types:  41%|████      | 1877/4569 [00:00<00:00, 3813.62it/s]Assigning cell types:  50%|████▉     | 2268/4569 [00:00<00:00, 3845.03it/s]Assigning cell types:  58%|█████▊    | 2661/4569 [00:00<00:00, 3870.01it/s]Assigning cell types:  67%|██████▋   | 3051/4569 [00:00<00:00, 3877.41it/s]Assigning cell types:  75%|███████▌  | 3442/4569 [00:00<00:00, 3885.42it/s]Assigning cell types:  84%|████████▍ | 3834/4569 [00:01<00:00, 3895.04it/s]Assigning cell types:  93%|█████████▎| 4227/4569 [00:01<00:00, 3902.99it/s]Assigning cell types: 100%|██████████| 4569/4569 [00:01<00:00, 3837.59it/s]
match
True     25572
False     1494
Name: count, dtype: int64 0.9448015960984261
SPOT_1_5 -1.0 6 7.0 [2. 0. 0. 3. 2.]
SPOT_1_5 0.0 6 7.0 [1. 0. 0. 3. 2.]
SPOT_1_44 -1.0 6 7.0 [2. 0. 0. 3. 2.]
SPOT_1_44 0.0 6 7.0 [1. 0. 0. 3. 2.]
SPOT_3_60 -1.0 8 9.0 [2. 2. 0. 5. 0.]
SPOT_3_60 0.0 8 9.0 [1. 2. 0. 5. 0.]
SPOT_8_62 -1.0 8 9.0 [0. 2. 2. 5. 0.]
SPOT_8_62 0.0 8 9.0 [0. 1. 2. 5. 0.]
SPOT_9_49 -1.0 7 8.0 [2. 0. 2. 4. 0.]
SPOT_9_49 0.0 7 8.0 [1. 0. 2. 4. 0.]
SPOT_11_53 -1.0 7 8.0 [2. 0. 0. 4. 2.]
SPOT_11_53 0.0 7 8.0 [1. 0. 0. 4. 2.]
SPOT_17_70 -1.0 7 8.0 [2. 0. 0. 4. 2.]
SPOT_17_70 0.0 7 8.0 [1. 0. 0. 4. 2.]
SPOT_19_78 -1.0 7 8.0 [2. 0. 0. 4. 2.]
SPOT_19_78 0.0 7 8.0 [1. 0. 0. 4. 2.]
SPOT_22_30 -1.0 9 10.0 [2. 0. 2. 6. 0.]
SPOT_22_30 0.0 9 10.0 [1. 0. 2. 6. 0.]
SPOT_32_53 -1.0 8 9.0 [2. 0. 3. 4. 0.]
SPOT_32_53 0.0 8 9.0 [1. 0. 3. 4. 0.]
SPOT_34_38 -1.0 7 8.0 [2. 0. 0. 4. 2.]
SPOT_34_38 0.0 7 8.0 [1. 0. 0. 4. 2.]
SPOT_35_30 -1.0 7 8.0 [2. 0. 2. 4. 0.]
SPOT_35_30 0.0 7 8.0 [1. 0. 2. 4. 0.]
SPOT_39_59 -1.0 7 8.0 [2. 0. 2. 4. 0.]
SPOT_39_59 0.0 7 8.0 [1. 0. 2. 4. 0.]
SPOT_49_28 -1.0 9 10.0 [2. 0. 2. 6. 0.]
SPOT_49_28 0.0 9 10.0 [1. 0. 2. 6. 0.]
Assigning cell types...
Assigning cell types:   0%|          | 0/4569 [00:00<?, ?it/s]Assigning cell types:   1%|          | 41/4569 [00:00<00:11, 401.67it/s]Assigning cell types:   2%|▏         | 85/4569 [00:00<00:10, 422.39it/s]Assigning cell types:   3%|▎         | 128/4569 [00:00<00:10, 422.14it/s]Assigning cell types:   4%|▍         | 172/4569 [00:00<00:10, 426.45it/s]Assigning cell types:   5%|▍         | 216/4569 [00:00<00:10, 429.50it/s]Assigning cell types:   6%|▌         | 260/4569 [00:00<00:09, 432.60it/s]Assigning cell types:   7%|▋         | 304/4569 [00:00<00:09, 433.45it/s]Assigning cell types:   8%|▊         | 348/4569 [00:00<00:09, 434.30it/s]Assigning cell types:   9%|▊         | 392/4569 [00:00<00:09, 433.58it/s]Assigning cell types:  10%|▉         | 436/4569 [00:01<00:09, 433.47it/s]Assigning cell types:  11%|█         | 480/4569 [00:01<00:09, 432.89it/s]Assigning cell types:  11%|█▏        | 524/4569 [00:01<00:09, 431.72it/s]Assigning cell types:  12%|█▏        | 568/4569 [00:01<00:09, 431.86it/s]Assigning cell types:  13%|█▎        | 612/4569 [00:01<00:09, 432.08it/s]Assigning cell types:  14%|█▍        | 656/4569 [00:01<00:09, 431.78it/s]Assigning cell types:  15%|█▌        | 700/4569 [00:01<00:08, 432.81it/s]Assigning cell types:  16%|█▋        | 744/4569 [00:01<00:08, 428.23it/s]Assigning cell types:  17%|█▋        | 788/4569 [00:01<00:08, 430.05it/s]Assigning cell types:  18%|█▊        | 832/4569 [00:01<00:08, 430.69it/s]Assigning cell types:  19%|█▉        | 876/4569 [00:02<00:08, 430.91it/s]Assigning cell types:  20%|██        | 920/4569 [00:02<00:08, 431.37it/s]Assigning cell types:  21%|██        | 964/4569 [00:02<00:08, 431.43it/s]Assigning cell types:  22%|██▏       | 1008/4569 [00:02<00:08, 431.42it/s]Assigning cell types:  23%|██▎       | 1052/4569 [00:02<00:08, 430.68it/s]Assigning cell types:  24%|██▍       | 1096/4569 [00:02<00:08, 431.35it/s]Assigning cell types:  25%|██▍       | 1140/4569 [00:02<00:07, 432.08it/s]Assigning cell types:  26%|██▌       | 1184/4569 [00:02<00:07, 431.80it/s]Assigning cell types:  27%|██▋       | 1228/4569 [00:02<00:07, 431.47it/s]Assigning cell types:  28%|██▊       | 1272/4569 [00:02<00:07, 431.70it/s]Assigning cell types:  29%|██▉       | 1316/4569 [00:03<00:07, 432.08it/s]Assigning cell types:  30%|██▉       | 1360/4569 [00:03<00:07, 427.54it/s]Assigning cell types:  31%|███       | 1404/4569 [00:03<00:07, 429.20it/s]Assigning cell types:  32%|███▏      | 1448/4569 [00:03<00:07, 430.22it/s]Assigning cell types:  33%|███▎      | 1492/4569 [00:03<00:07, 431.28it/s]Assigning cell types:  34%|███▎      | 1536/4569 [00:03<00:07, 431.55it/s]Assigning cell types:  35%|███▍      | 1580/4569 [00:03<00:06, 432.55it/s]Assigning cell types:  36%|███▌      | 1624/4569 [00:03<00:06, 432.51it/s]Assigning cell types:  37%|███▋      | 1668/4569 [00:03<00:06, 427.91it/s]Assigning cell types:  37%|███▋      | 1712/4569 [00:03<00:06, 430.10it/s]Assigning cell types:  38%|███▊      | 1756/4569 [00:04<00:06, 432.48it/s]Assigning cell types:  39%|███▉      | 1800/4569 [00:04<00:06, 433.43it/s]Assigning cell types:  40%|████      | 1844/4569 [00:04<00:06, 433.73it/s]Assigning cell types:  41%|████▏     | 1888/4569 [00:04<00:06, 432.97it/s]Assigning cell types:  42%|████▏     | 1932/4569 [00:04<00:06, 432.55it/s]Assigning cell types:  43%|████▎     | 1976/4569 [00:04<00:05, 433.40it/s]Assigning cell types:  44%|████▍     | 2020/4569 [00:04<00:05, 433.64it/s]Assigning cell types:  45%|████▌     | 2064/4569 [00:04<00:05, 432.57it/s]Assigning cell types:  46%|████▌     | 2108/4569 [00:04<00:05, 432.22it/s]Assigning cell types:  47%|████▋     | 2152/4569 [00:04<00:05, 432.78it/s]Assigning cell types:  48%|████▊     | 2196/4569 [00:05<00:05, 433.32it/s]Assigning cell types:  49%|████▉     | 2240/4569 [00:05<00:05, 434.59it/s]Assigning cell types:  50%|████▉     | 2284/4569 [00:05<00:05, 434.76it/s]Assigning cell types:  51%|█████     | 2328/4569 [00:05<00:05, 435.11it/s]Assigning cell types:  52%|█████▏    | 2372/4569 [00:05<00:05, 435.02it/s]Assigning cell types:  53%|█████▎    | 2416/4569 [00:05<00:04, 435.55it/s]Assigning cell types:  54%|█████▍    | 2460/4569 [00:05<00:04, 435.27it/s]Assigning cell types:  55%|█████▍    | 2504/4569 [00:05<00:04, 430.65it/s]Assigning cell types:  56%|█████▌    | 2548/4569 [00:05<00:04, 431.46it/s]Assigning cell types:  57%|█████▋    | 2592/4569 [00:06<00:04, 432.93it/s]Assigning cell types:  58%|█████▊    | 2636/4569 [00:06<00:04, 433.74it/s]Assigning cell types:  59%|█████▊    | 2680/4569 [00:06<00:04, 434.71it/s]Assigning cell types:  60%|█████▉    | 2724/4569 [00:06<00:04, 435.44it/s]Assigning cell types:  61%|██████    | 2768/4569 [00:06<00:04, 436.06it/s]Assigning cell types:  62%|██████▏   | 2812/4569 [00:06<00:04, 435.37it/s]Assigning cell types:  63%|██████▎   | 2856/4569 [00:06<00:03, 435.80it/s]Assigning cell types:  63%|██████▎   | 2900/4569 [00:06<00:03, 435.18it/s]Assigning cell types:  64%|██████▍   | 2944/4569 [00:06<00:03, 435.29it/s]Assigning cell types:  65%|██████▌   | 2988/4569 [00:06<00:03, 435.68it/s]Assigning cell types:  66%|██████▋   | 3032/4569 [00:07<00:03, 435.87it/s]Assigning cell types:  67%|██████▋   | 3076/4569 [00:07<00:03, 434.90it/s]Assigning cell types:  68%|██████▊   | 3120/4569 [00:07<00:03, 434.02it/s]Assigning cell types:  69%|██████▉   | 3164/4569 [00:07<00:03, 433.39it/s]Assigning cell types:  70%|███████   | 3208/4569 [00:07<00:03, 432.57it/s]Assigning cell types:  71%|███████   | 3252/4569 [00:07<00:03, 432.19it/s]Assigning cell types:  72%|███████▏  | 3296/4569 [00:07<00:02, 433.17it/s]Assigning cell types:  73%|███████▎  | 3340/4569 [00:07<00:02, 433.32it/s]Assigning cell types:  74%|███████▍  | 3384/4569 [00:07<00:02, 433.68it/s]Assigning cell types:  75%|███████▌  | 3428/4569 [00:07<00:02, 433.59it/s]Assigning cell types:  76%|███████▌  | 3472/4569 [00:08<00:02, 433.17it/s]Assigning cell types:  77%|███████▋  | 3516/4569 [00:08<00:02, 432.90it/s]Assigning cell types:  78%|███████▊  | 3560/4569 [00:08<00:02, 432.71it/s]Assigning cell types:  79%|███████▉  | 3604/4569 [00:08<00:02, 433.71it/s]Assigning cell types:  80%|███████▉  | 3648/4569 [00:08<00:02, 433.54it/s]Assigning cell types:  81%|████████  | 3692/4569 [00:08<00:02, 433.11it/s]Assigning cell types:  82%|████████▏ | 3736/4569 [00:08<00:01, 432.44it/s]Assigning cell types:  83%|████████▎ | 3780/4569 [00:08<00:01, 431.65it/s]Assigning cell types:  84%|████████▎ | 3824/4569 [00:08<00:01, 432.15it/s]Assigning cell types:  85%|████████▍ | 3868/4569 [00:08<00:01, 432.25it/s]Assigning cell types:  86%|████████▌ | 3912/4569 [00:09<00:01, 431.63it/s]Assigning cell types:  87%|████████▋ | 3956/4569 [00:09<00:01, 431.71it/s]Assigning cell types:  88%|████████▊ | 4000/4569 [00:09<00:01, 432.65it/s]Assigning cell types:  89%|████████▊ | 4044/4569 [00:09<00:01, 433.25it/s]Assigning cell types:  89%|████████▉ | 4088/4569 [00:09<00:01, 433.27it/s]Assigning cell types:  90%|█████████ | 4132/4569 [00:09<00:01, 433.57it/s]Assigning cell types:  91%|█████████▏| 4176/4569 [00:09<00:00, 434.01it/s]Assigning cell types:  92%|█████████▏| 4220/4569 [00:09<00:00, 434.26it/s]Assigning cell types:  93%|█████████▎| 4264/4569 [00:09<00:00, 431.73it/s]Assigning cell types:  94%|█████████▍| 4308/4569 [00:09<00:00, 432.98it/s]Assigning cell types:  95%|█████████▌| 4352/4569 [00:10<00:00, 432.30it/s]Assigning cell types:  96%|█████████▌| 4396/4569 [00:10<00:00, 432.57it/s]Assigning cell types:  97%|█████████▋| 4440/4569 [00:10<00:00, 432.81it/s]Assigning cell types:  98%|█████████▊| 4484/4569 [00:10<00:00, 433.50it/s]Assigning cell types:  99%|█████████▉| 4528/4569 [00:10<00:00, 433.91it/s]Assigning cell types: 100%|██████████| 4569/4569 [00:10<00:00, 432.55it/s]
        spot_name     cell_id true_cell_type  ...             y  cell_type match
0        SPOT_0_0  kfacnicf-1          Tumor  ...  10085.500264      Tumor  True
1        SPOT_0_0  kfacnmif-1          Tumor  ...  10075.256557      Tumor  True
2        SPOT_0_0  kfaeligm-1          Tumor  ...  10010.149937      Tumor  True
3        SPOT_0_0  kfaeljkg-1          Tumor  ...  10010.060251      Tumor  True
4        SPOT_0_0  kfafmjpi-1          Tumor  ...  10058.876817      Tumor  True
...           ...         ...            ...  ...           ...        ...   ...
27061  SPOT_50_20  abdaebgm-1          Tumor  ...  12021.306081      Tumor  True
27062  SPOT_50_28  abgpglel-1          Tumor  ...  12816.212020      Tumor  True
27063  SPOT_50_39  gcacponh-1          Tumor  ...  13905.364321      Tumor  True
27064  SPOT_50_48  gfobhfgf-1          Tumor  ...  14812.878338      Tumor  True
27065  SPOT_50_58  bgmpchhj-1          Tumor  ...  15886.603271      Tumor  True

[27066 rows x 7 columns]
match
True     26496
False      570
Name: count, dtype: int64 0.9789403679893594
Constructing SVC adata...
Number of cells processed: 27066
Number of unique spots: 4569
Shape of SVC_X: (27066, 500)
AnnData object with n_obs × n_vars = 27066 × 500
    obs: 'spot_name', 'cell_id', 'true_cell_type', 'x', 'y', 'cell_type', 'match'
500 500 500
Normalizing and log-transforming data.
PCC: 0.7970, 0.9568, 0.5839
SSIM: 0.4706, 0.9478, 0.2287
MSE: 0.1990, 0.4182, 0.0359
NRMSE: 0.4956, 3.1227, 0.0759
Normalizing and log-transforming data.
PCC: 0.7970, 0.9568, 0.5839
SSIM: 0.4705, 0.9479, 0.2297
MSE: 0.0092, 0.0206, 0.0015
NRMSE: 0.5002, 3.1191, 0.0793


PCC: 0.8907, 0.9663, 0.8161
SSIM: 0.7599, 0.9905, 0.4020
MSE: 73.8693, 279.7662, 5.4960
NRMSE: 1.2384, 4.8142, 0.1540
PCC: 0.8907, 0.9663, 0.8161
SSIM: 0.7613, 0.9906, 0.4021
MSE: 0.0060, 0.0252, 0.0007
NRMSE: 1.2742, 4.9806, 0.1554
Finish
