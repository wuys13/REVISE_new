simulation
        spot_name     cell_id  ...             x             y
0        SPOT_0_7  ijldgidh-1  ...  52090.011216  13727.806521
1       SPOT_0_10  iilbaocp-1  ...  52034.527019  14048.884925
2       SPOT_0_28  mfolpnnb-1  ...  52076.845224  15836.844461
3       SPOT_0_28  mfonhjne-1  ...  52047.806805  15819.132512
4       SPOT_0_46  mfdfddbc-1  ...  52022.318295  17641.256876
...           ...         ...  ...           ...           ...
12236  SPOT_49_92  flmjifgp-1  ...  56919.954967  22265.374586
12237  SPOT_49_95  flmgofki-1  ...  56932.084479  22500.626738
12238  SPOT_49_98  fmdbkcnh-1  ...  56992.961389  22895.937252
12239  SPOT_49_98  fmdcdjmh-1  ...  56922.400513  22890.895641
12240  SPOT_49_98  fmdcelpj-1  ...  56954.307033  22888.955187

[12241 rows x 5 columns]
There are 7 cell types: ['Fibroblast', 'Intestinal Epithelial', 'Mono/Macro', 'Plasma', 'SMC', 'T', 'Vascular EC']
label
Fibroblast               50
Intestinal Epithelial    50
Mono/Macro               50
Plasma                   50
SMC                      50
T                        50
Vascular EC              50
Name: count, dtype: int64
0it [00:00, ?it/s]7it [00:00, 671.01it/s]
0it [00:00, ?it/s]7it [00:00, 420.47it/s]
(7, 350) (7, 700)
Calculating cell contributions and PM_on_cell...
[0.9828468  0.98065317 0.9800521  ... 0.5091449  0.98234    0.9545244 ]
Assigning cell types:   0%|          | 0/3113 [00:00<?, ?it/s]Assigning cell types:  12%|█▏        | 361/3113 [00:00<00:00, 3604.31it/s]Assigning cell types:  24%|██▍       | 746/3113 [00:00<00:00, 3744.28it/s]Assigning cell types:  36%|███▋      | 1131/3113 [00:00<00:00, 3788.79it/s]Assigning cell types:  49%|████▉     | 1523/3113 [00:00<00:00, 3837.69it/s]Assigning cell types:  61%|██████▏   | 1907/3113 [00:00<00:00, 3809.10it/s]Assigning cell types:  74%|███████▍  | 2296/3113 [00:00<00:00, 3833.44it/s]Assigning cell types:  86%|████████▌ | 2680/3113 [00:00<00:00, 3332.96it/s]Assigning cell types:  99%|█████████▊| 3071/3113 [00:00<00:00, 3496.53it/s]Assigning cell types: 100%|██████████| 3113/3113 [00:00<00:00, 3616.36it/s]
match
True     11019
False     1222
Name: count, dtype: int64 0.9001715546115513
SPOT_29_10 -1.0 9 10.0 [0. 1. 0. 4. 0. 5. 0.]
SPOT_29_10 0.0 9 10.0 [0. 0. 0. 4. 0. 5. 0.]
Assigning cell types...
Assigning cell types:   0%|          | 0/3113 [00:00<?, ?it/s]Assigning cell types:   3%|▎         | 90/3113 [00:00<00:03, 891.72it/s]Assigning cell types:   6%|▌         | 184/3113 [00:00<00:03, 919.51it/s]Assigning cell types:   9%|▉         | 279/3113 [00:00<00:03, 931.74it/s]Assigning cell types:  12%|█▏        | 374/3113 [00:00<00:02, 937.68it/s]Assigning cell types:  15%|█▌        | 469/3113 [00:00<00:02, 940.68it/s]Assigning cell types:  18%|█▊        | 564/3113 [00:00<00:02, 940.84it/s]Assigning cell types:  21%|██        | 659/3113 [00:00<00:02, 930.75it/s]Assigning cell types:  24%|██▍       | 753/3113 [00:00<00:02, 929.45it/s]Assigning cell types:  27%|██▋       | 846/3113 [00:00<00:02, 928.32it/s]Assigning cell types:  30%|███       | 940/3113 [00:01<00:02, 929.41it/s]Assigning cell types:  33%|███▎      | 1033/3113 [00:01<00:02, 928.23it/s]Assigning cell types:  36%|███▌      | 1126/3113 [00:01<00:02, 926.36it/s]Assigning cell types:  39%|███▉      | 1219/3113 [00:01<00:02, 923.65it/s]Assigning cell types:  42%|████▏     | 1312/3113 [00:01<00:01, 922.63it/s]Assigning cell types:  45%|████▌     | 1405/3113 [00:01<00:01, 909.67it/s]Assigning cell types:  48%|████▊     | 1497/3113 [00:01<00:01, 911.08it/s]Assigning cell types:  51%|█████     | 1589/3113 [00:01<00:01, 913.30it/s]Assigning cell types:  54%|█████▍    | 1681/3113 [00:01<00:01, 914.45it/s]Assigning cell types:  57%|█████▋    | 1773/3113 [00:01<00:01, 915.70it/s]Assigning cell types:  60%|█████▉    | 1865/3113 [00:02<00:01, 916.73it/s]Assigning cell types:  63%|██████▎   | 1957/3113 [00:02<00:01, 916.41it/s]Assigning cell types:  66%|██████▌   | 2049/3113 [00:02<00:01, 916.92it/s]Assigning cell types:  69%|██████▉   | 2141/3113 [00:02<00:01, 915.81it/s]Assigning cell types:  72%|███████▏  | 2233/3113 [00:02<00:00, 915.17it/s]Assigning cell types:  75%|███████▍  | 2325/3113 [00:02<00:00, 915.51it/s]Assigning cell types:  78%|███████▊  | 2417/3113 [00:02<00:00, 913.64it/s]Assigning cell types:  81%|████████  | 2509/3113 [00:02<00:00, 914.68it/s]Assigning cell types:  84%|████████▎ | 2601/3113 [00:02<00:00, 914.92it/s]Assigning cell types:  87%|████████▋ | 2693/3113 [00:02<00:00, 914.99it/s]Assigning cell types:  89%|████████▉ | 2785/3113 [00:03<00:00, 916.03it/s]Assigning cell types:  92%|█████████▏| 2877/3113 [00:03<00:00, 907.37it/s]Assigning cell types:  95%|█████████▌| 2969/3113 [00:03<00:00, 909.46it/s]Assigning cell types:  98%|█████████▊| 3061/3113 [00:03<00:00, 911.13it/s]Assigning cell types: 100%|██████████| 3113/3113 [00:03<00:00, 918.87it/s]
        spot_name     cell_id  ...              cell_type  match
0        SPOT_0_7  ijldgidh-1  ...             Fibroblast   True
1       SPOT_0_10  iilbaocp-1  ...            Vascular EC   True
2       SPOT_0_28  mfolpnnb-1  ...            Vascular EC   True
3       SPOT_0_28  mfonhjne-1  ...            Vascular EC   True
4       SPOT_0_46  mfdfddbc-1  ...            Vascular EC   True
...           ...         ...  ...                    ...    ...
12236  SPOT_49_92  flmjifgp-1  ...             Mono/Macro  False
12237  SPOT_49_95  flmgofki-1  ...                      T   True
12238  SPOT_49_98  fmdbkcnh-1  ...  Intestinal Epithelial   True
12239  SPOT_49_98  fmdcdjmh-1  ...  Intestinal Epithelial   True
12240  SPOT_49_98  fmdcelpj-1  ...  Intestinal Epithelial   True

[12241 rows x 7 columns]
match
True     12172
False       69
Name: count, dtype: int64 0.9943632056204559
Constructing SVC adata...
Number of cells processed: 12241
Number of unique spots: 3113
Shape of SVC_X: (12241, 700)
AnnData object with n_obs × n_vars = 12241 × 700
    obs: 'spot_name', 'cell_id', 'true_cell_type', 'x', 'y', 'cell_type', 'match'
700 700 700
Normalizing and log-transforming data.
PCC: 0.9182, 0.9905, 0.7932
SSIM: 0.5956, 0.9721, 0.3536
MSE: 0.1010, 0.1807, 0.0108
NRMSE: 0.2742, 1.0857, 0.0634
Normalizing and log-transforming data.
PCC: 0.9182, 0.9905, 0.7932
SSIM: 0.5958, 0.9722, 0.3534
MSE: 0.0047, 0.0096, 0.0005
NRMSE: 0.2745, 1.0843, 0.0631


PCC: 0.9814, 0.9995, 0.9325
SSIM: 0.8582, 0.9885, 0.6404
MSE: 17.6111, 101.4454, 0.1618
NRMSE: 0.4296, 1.7667, 0.1195
PCC: 0.9814, 0.9995, 0.9325
SSIM: 0.8588, 0.9885, 0.6391
MSE: 0.0016, 0.0141, 0.0000
NRMSE: 0.4458, 1.7533, 0.1143
Finish
